{"version":3,"file":"polite-newsletter-forms.modern.js","sources":["../src/helpers/localstorage-db.js","../src/helpers/mini-events.js","../src/helpers/globals.js","../src/helpers/dom-ready.js","../src/helpers/init-data-watchers.js","../src/helpers/throttle.js","../node_modules/body-scroll-lock/lib/bodyScrollLock.mjs","../src/modal/close-modal.js","../src/helpers/init-debug-notice.js","../src/init-email-forms.js","../src/helpers/on-exit-intent.js","../src/modal/init-modal.js","../src/modal/get-template-string.js","../src/modal/init-modal-event-listeners.js","../src/modal/init-modal-data-watchers.js","../src/modal/get-trigger-options.js","../src/modal/open-modal.js","../src/index.js"],"sourcesContent":["// simple localStorage database\nfunction set (itemName, itemValue) {\n  let databaseString = localStorage.getItem(\"an-awesome-localstorage-db\");\n  let databaseObject = databaseString ? JSON.parse(databaseString) : {};\n  databaseObject[itemName] = itemValue;\n  localStorage.setItem(\"an-awesome-localstorage-db\", JSON.stringify(databaseObject));\n  return itemValue;\n}\n\nfunction get (itemName) {\n  let databaseString = localStorage.getItem(\"an-awesome-localstorage-db\");\n  let databaseObject = databaseString ? JSON.parse(localStorage.getItem(\"an-awesome-localstorage-db\")) : {};\n  return databaseObject[itemName];\n}\n\nfunction increment (itemName) {\n  let num = get(itemName) || 0;\n  num++;\n  set(itemName, num);\n  return num;\n}\n\nexport default {\n  set,\n  get,\n  increment\n}\n","function trigger (name, value) {\n  let event = new CustomEvent(name, { detail: value });\n  document.dispatchEvent(event);\n}\n\nfunction listen (name, cb) {\n  document.addEventListener(name, function (event) {\n    cb(event.detail);\n  }, false);\n}\n\nexport default {\n  trigger,\n  listen\n}","import db from \"./localstorage-db\";\nimport MiniEvents from \"./mini-events\";\n\nexport default {\n  WEBSITE_TYPES: {\n    CONTENT: \"CONTENT\",\n    MARKETING: \"MARKETING\"\n  },\n  FOCUSABLE_SELECTORS: 'a[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), *[tabindex]',\n  IS_MOBILE: window.matchMedia(\"only screen and (max-width: 780px)\").matches,\n  MODAL_ELEM_CLASS: '.email-modal',\n  MODAL_ELEM_FORM_CLASS: '.email-modal__content',\n  MODAL_ELEM_CLOSE_BUTTON_CLASS: '.email-modal__close',\n  BODY_CLASS_MODAL_OPEN: 'email-modal-is-open',\n  MODAL_IS_OPENABLE: false,\n  SITE_PAGE_VIEWS: 0,\n  HIGHEST_SCROLL_PERCENTAGE: 0,\n  ACTIVE_TIME_ON_SITE: 0,\n  ACTIVE_TIME_ON_PAGE: 0,\n  // TODO:\n  // MODAL_VIEW_COUNT, \n  // CLOSED_MODAL_DATE, \n  // CLOSED_MODAL_IN_PAST_TWO_WEEKS, \n  // CLOSED_BOTTOM_BAR_DATE,\n  // CLOSED_BOTTOM_BAR_IN_PAST_TWO_WEEKS,\n  setActiveElement (el) {\n    this.activeElement = el;\n  },\n  getActiveElement () {\n    return this.activeElement;\n  },\n  setModalAsOpenable () {\n    this.MODAL_IS_OPENABLE = true;\n    MiniEvents.trigger(\"MODAL_IS_OPENABLE\", true);\n  },\n  isModalOpenable () {\n    return this.MODAL_IS_OPENABLE;\n  },\n  getHighestScrollPercentage () {\n    return this.HIGHEST_SCROLL_PERCENTAGE;\n  },\n  getActiveTimeOnSite () {\n    return this.ACTIVE_TIME_ON_SITE;\n  },\n  getActiveTimeOnPage () {\n    return this.ACTIVE_TIME_ON_PAGE;\n  },\n  incrementSitePageViews () {\n    let pageViews = db.increment(\"pageViews\");\n    this.SITE_PAGE_VIEWS = pageViews;\n\n    MiniEvents.trigger(\"pageData\", {pageViews});\n  },\n  setHighestScrollPercentage (num) {\n    let savedScrollPercentage = db.get(\"highestScrollPercentage\") || 0;\n\n    let highestScrollPercentage = num > savedScrollPercentage ? num : savedScrollPercentage;\n\n    db.set(\"highestScrollPercentage\", highestScrollPercentage);\n    this.HIGHEST_SCROLL_PERCENTAGE = highestScrollPercentage;\n\n    MiniEvents.trigger(\"pageData\", {highestScrollPercentage});\n  },\n  incrementActiveTimeOnSite (seconds) {\n    let activeTimeOnSite = db.increment(\"activeTimeOnSite\");\n    this.ACTIVE_TIME_ON_SITE = activeTimeOnSite;\n\n    MiniEvents.trigger(\"pageData\", {activeTimeOnSite});\n  },\n  incrementActiveTimeOnPage (seconds) {\n    this.ACTIVE_TIME_ON_PAGE += 1;\n    MiniEvents.trigger(\"pageData\", {activeTimeOnPage: this.ACTIVE_TIME_ON_PAGE});\n  }\n}\n\n\n\n\n\n","export default function domReady(fn) {\n  if (document.readyState != 'loading'){\n    fn();\n  } else {\n    document.addEventListener('DOMContentLoaded', fn);\n  }\n}","import globals from \"./globals\";\nimport throttle from \"./throttle\";\nimport domReady from \"./dom-ready\";\n\nfunction getScrollPercentage () {\n  // get the scroll height of the document (https://javascript.info/size-and-scroll-window#width-height-of-the-document) \n  let docScrollHeight = Math.max(document.body.scrollHeight, document.documentElement.scrollHeight, document.body.offsetHeight, document.documentElement.offsetHeight, document.body.clientHeight, document.documentElement.clientHeight);\n  // calculate scroll percentage (subtract browser height since that's not actually scrollable)\n  let scrollPercentage = window.pageYOffset / (docScrollHeight - document.documentElement.clientHeight);\n  // calculate percentage\n  return Math.floor(scrollPercentage * 100);\n}\n\nlet setCurrentScrollPercentageThrottled = throttle(1000, function () {\n  // the following code will execute every time the user scrolls\n  // as well as after every second of that scroll\n\n  globals.setHighestScrollPercentage(getScrollPercentage());\n  globals.incrementActiveTimeOnSite();\n  globals.incrementActiveTimeOnPage();\n});\n\nexport default function initDataWatchers () {\n  globals.incrementSitePageViews();\n\n  domReady(function () {\n    window.addEventListener('scroll', setCurrentScrollPercentageThrottled);\n  });\n}\n\n\n\n\n\n\n\n","/* eslint-disable no-undefined,no-param-reassign,no-shadow */\n\n/**\n * Throttle execution of a function. Especially useful for rate limiting\n * execution of handlers on events like resize and scroll.\n *\n * @param  {Number}    delay          A zero-or-greater delay in milliseconds. For event callbacks, values around 100 or 250 (or even higher) are most useful.\n * @param  {Boolean}   [noTrailing]   Optional, defaults to false. If noTrailing is true, callback will only execute every `delay` milliseconds while the\n *                                    throttled-function is being called. If noTrailing is false or unspecified, callback will be executed one final time\n *                                    after the last throttled-function call. (After the throttled-function has not been called for `delay` milliseconds,\n *                                    the internal counter is reset)\n * @param  {Function}  callback       A function to be executed after delay milliseconds. The `this` context and all arguments are passed through, as-is,\n *                                    to `callback` when the throttled-function is executed.\n * @param  {Boolean}   [debounceMode] If `debounceMode` is true (at begin), schedule `clear` to execute after `delay` ms. If `debounceMode` is false (at end),\n *                                    schedule `callback` to execute after `delay` ms.\n *\n * @return {Function}  A new, throttled, function.\n */\nexport default function ( delay, noTrailing, callback, debounceMode ) {\n\n  /*\n   * After wrapper has stopped being called, this timeout ensures that\n   * `callback` is executed at the proper times in `throttle` and `end`\n   * debounce modes.\n   */\n  var timeoutID;\n  var cancelled = false;\n\n  // Keep track of the last time `callback` was executed.\n  var lastExec = 0;\n\n  // Function to clear existing timeout\n  function clearExistingTimeout () {\n    if ( timeoutID ) {\n      clearTimeout(timeoutID);\n    }\n  }\n\n  // Function to cancel next exec\n  function cancel () {\n    clearExistingTimeout();\n    cancelled = true;\n  }\n\n\n  // `noTrailing` defaults to falsy.\n  if ( typeof noTrailing !== 'boolean' ) {\n    debounceMode = callback;\n    callback = noTrailing;\n    noTrailing = undefined;\n  }\n\n  /*\n   * The `wrapper` function encapsulates all of the throttling / debouncing\n   * functionality and when executed will limit the rate at which `callback`\n   * is executed.\n   */\n  function wrapper () {\n\n    var self = this;\n    var elapsed = Date.now() - lastExec;\n    var args = arguments;\n\n    if (cancelled) {\n      return;\n    }\n\n    // Execute `callback` and update the `lastExec` timestamp.\n    function exec () {\n      lastExec = Date.now();\n      callback.apply(self, args);\n    }\n\n    /*\n     * If `debounceMode` is true (at begin) this is used to clear the flag\n     * to allow future `callback` executions.\n     */\n    function clear () {\n      timeoutID = undefined;\n    }\n\n    if ( debounceMode && !timeoutID ) {\n      /*\n       * Since `wrapper` is being called for the first time and\n       * `debounceMode` is true (at begin), execute `callback`.\n       */\n      exec();\n    }\n\n    clearExistingTimeout();\n\n    if ( debounceMode === undefined && elapsed > delay ) {\n      /*\n       * In throttle mode, if `delay` time has been exceeded, execute\n       * `callback`.\n       */\n      exec();\n\n    } else if ( noTrailing !== true ) {\n      /*\n       * In trailing throttle mode, since `delay` time has not been\n       * exceeded, schedule `callback` to execute `delay` ms after most\n       * recent execution.\n       *\n       * If `debounceMode` is true (at begin), schedule `clear` to execute\n       * after `delay` ms.\n       *\n       * If `debounceMode` is false (at end), schedule `callback` to\n       * execute after `delay` ms.\n       */\n      timeoutID = setTimeout(debounceMode ? clear : exec, debounceMode === undefined ? delay - elapsed : delay);\n    }\n\n  }\n\n  wrapper.cancel = cancel;\n\n  // Return the wrapper function.\n  return wrapper;\n\n}","function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\n// Older browsers don't support event options, feature detect it.\n\n// Adopted and modified solution from Bohdan Didukh (2017)\n// https://stackoverflow.com/questions/41594997/ios-10-safari-prevent-scrolling-behind-a-fixed-overlay-and-maintain-scroll-posi\n\nvar hasPassiveEvents = false;\nif (typeof window !== 'undefined') {\n  var passiveTestOptions = {\n    get passive() {\n      hasPassiveEvents = true;\n      return undefined;\n    }\n  };\n  window.addEventListener('testPassive', null, passiveTestOptions);\n  window.removeEventListener('testPassive', null, passiveTestOptions);\n}\n\nvar isIosDevice = typeof window !== 'undefined' && window.navigator && window.navigator.platform && (/iP(ad|hone|od)/.test(window.navigator.platform) || window.navigator.platform === 'MacIntel' && window.navigator.maxTouchPoints > 1);\n\n\nvar locks = [];\nvar documentListenerAdded = false;\nvar initialClientY = -1;\nvar previousBodyOverflowSetting = void 0;\nvar previousBodyPaddingRight = void 0;\n\n// returns true if `el` should be allowed to receive touchmove events.\nvar allowTouchMove = function allowTouchMove(el) {\n  return locks.some(function (lock) {\n    if (lock.options.allowTouchMove && lock.options.allowTouchMove(el)) {\n      return true;\n    }\n\n    return false;\n  });\n};\n\nvar preventDefault = function preventDefault(rawEvent) {\n  var e = rawEvent || window.event;\n\n  // For the case whereby consumers adds a touchmove event listener to document.\n  // Recall that we do document.addEventListener('touchmove', preventDefault, { passive: false })\n  // in disableBodyScroll - so if we provide this opportunity to allowTouchMove, then\n  // the touchmove event on document will break.\n  if (allowTouchMove(e.target)) {\n    return true;\n  }\n\n  // Do not prevent if the event has more than one touch (usually meaning this is a multi touch gesture like pinch to zoom).\n  if (e.touches.length > 1) return true;\n\n  if (e.preventDefault) e.preventDefault();\n\n  return false;\n};\n\nvar setOverflowHidden = function setOverflowHidden(options) {\n  // Setting overflow on body/documentElement synchronously in Desktop Safari slows down\n  // the responsiveness for some reason. Setting within a setTimeout fixes this.\n  setTimeout(function () {\n    // If previousBodyPaddingRight is already set, don't set it again.\n    if (previousBodyPaddingRight === undefined) {\n      var _reserveScrollBarGap = !!options && options.reserveScrollBarGap === true;\n      var scrollBarGap = window.innerWidth - document.documentElement.clientWidth;\n\n      if (_reserveScrollBarGap && scrollBarGap > 0) {\n        previousBodyPaddingRight = document.body.style.paddingRight;\n        document.body.style.paddingRight = scrollBarGap + 'px';\n      }\n    }\n\n    // If previousBodyOverflowSetting is already set, don't set it again.\n    if (previousBodyOverflowSetting === undefined) {\n      previousBodyOverflowSetting = document.body.style.overflow;\n      document.body.style.overflow = 'hidden';\n    }\n  });\n};\n\nvar restoreOverflowSetting = function restoreOverflowSetting() {\n  // Setting overflow on body/documentElement synchronously in Desktop Safari slows down\n  // the responsiveness for some reason. Setting within a setTimeout fixes this.\n  setTimeout(function () {\n    if (previousBodyPaddingRight !== undefined) {\n      document.body.style.paddingRight = previousBodyPaddingRight;\n\n      // Restore previousBodyPaddingRight to undefined so setOverflowHidden knows it\n      // can be set again.\n      previousBodyPaddingRight = undefined;\n    }\n\n    if (previousBodyOverflowSetting !== undefined) {\n      document.body.style.overflow = previousBodyOverflowSetting;\n\n      // Restore previousBodyOverflowSetting to undefined\n      // so setOverflowHidden knows it can be set again.\n      previousBodyOverflowSetting = undefined;\n    }\n  });\n};\n\n// https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollHeight#Problems_and_solutions\nvar isTargetElementTotallyScrolled = function isTargetElementTotallyScrolled(targetElement) {\n  return targetElement ? targetElement.scrollHeight - targetElement.scrollTop <= targetElement.clientHeight : false;\n};\n\nvar handleScroll = function handleScroll(event, targetElement) {\n  var clientY = event.targetTouches[0].clientY - initialClientY;\n\n  if (allowTouchMove(event.target)) {\n    return false;\n  }\n\n  if (targetElement && targetElement.scrollTop === 0 && clientY > 0) {\n    // element is at the top of its scroll.\n    return preventDefault(event);\n  }\n\n  if (isTargetElementTotallyScrolled(targetElement) && clientY < 0) {\n    // element is at the bottom of its scroll.\n    return preventDefault(event);\n  }\n\n  event.stopPropagation();\n  return true;\n};\n\nexport var disableBodyScroll = function disableBodyScroll(targetElement, options) {\n  if (isIosDevice) {\n    // targetElement must be provided, and disableBodyScroll must not have been\n    // called on this targetElement before.\n    if (!targetElement) {\n      // eslint-disable-next-line no-console\n      console.error('disableBodyScroll unsuccessful - targetElement must be provided when calling disableBodyScroll on IOS devices.');\n      return;\n    }\n\n    if (targetElement && !locks.some(function (lock) {\n      return lock.targetElement === targetElement;\n    })) {\n      var lock = {\n        targetElement: targetElement,\n        options: options || {}\n      };\n\n      locks = [].concat(_toConsumableArray(locks), [lock]);\n\n      targetElement.ontouchstart = function (event) {\n        if (event.targetTouches.length === 1) {\n          // detect single touch.\n          initialClientY = event.targetTouches[0].clientY;\n        }\n      };\n      targetElement.ontouchmove = function (event) {\n        if (event.targetTouches.length === 1) {\n          // detect single touch.\n          handleScroll(event, targetElement);\n        }\n      };\n\n      if (!documentListenerAdded) {\n        document.addEventListener('touchmove', preventDefault, hasPassiveEvents ? { passive: false } : undefined);\n        documentListenerAdded = true;\n      }\n    }\n  } else {\n    setOverflowHidden(options);\n    var _lock = {\n      targetElement: targetElement,\n      options: options || {}\n    };\n\n    locks = [].concat(_toConsumableArray(locks), [_lock]);\n  }\n};\n\nexport var clearAllBodyScrollLocks = function clearAllBodyScrollLocks() {\n  if (isIosDevice) {\n    // Clear all locks ontouchstart/ontouchmove handlers, and the references.\n    locks.forEach(function (lock) {\n      lock.targetElement.ontouchstart = null;\n      lock.targetElement.ontouchmove = null;\n    });\n\n    if (documentListenerAdded) {\n      document.removeEventListener('touchmove', preventDefault, hasPassiveEvents ? { passive: false } : undefined);\n      documentListenerAdded = false;\n    }\n\n    locks = [];\n\n    // Reset initial clientY.\n    initialClientY = -1;\n  } else {\n    restoreOverflowSetting();\n    locks = [];\n  }\n};\n\nexport var enableBodyScroll = function enableBodyScroll(targetElement) {\n  if (isIosDevice) {\n    if (!targetElement) {\n      // eslint-disable-next-line no-console\n      console.error('enableBodyScroll unsuccessful - targetElement must be provided when calling enableBodyScroll on IOS devices.');\n      return;\n    }\n\n    targetElement.ontouchstart = null;\n    targetElement.ontouchmove = null;\n\n    locks = locks.filter(function (lock) {\n      return lock.targetElement !== targetElement;\n    });\n\n    if (documentListenerAdded && locks.length === 0) {\n      document.removeEventListener('touchmove', preventDefault, hasPassiveEvents ? { passive: false } : undefined);\n\n      documentListenerAdded = false;\n    }\n  } else {\n    locks = locks.filter(function (lock) {\n      return lock.targetElement !== targetElement;\n    });\n    if (!locks.length) {\n      restoreOverflowSetting();\n    }\n  }\n};\n\n","import { enableBodyScroll } from 'body-scroll-lock';\nimport globals from \"../helpers/globals\";\n\nexport default function closeModal() {\n  document.body.classList.remove(globals.BODY_CLASS_MODAL_OPEN);\n\n  // TODO: keep track of when the modal was closed\n  // setItemLocalStorage(\"modalClosedDate\", Date.now());\n\n  // hide the modal\n  globals.modalElem.style.display = 'none';\n\n  // Untrap the tab focus by removing tabindex=-1. You should restore previous values if an element had them.    \n  const focusableElements = document.querySelectorAll(globals.FOCUSABLE_SELECTORS);\n  focusableElements.forEach(el => el.removeAttribute('tabindex'));\n  \n  // Untrap screen reader focus\n  const topLevelElements = document.querySelectorAll(\"body > [aria-hidden]\");\n  topLevelElements.forEach(el => el.removeAttribute('aria-hidden'));\n  globals.modalElem.setAttribute('aria-hidden', 'true');\n  \n  // restore focus to the triggering element\n  let activeElement = globals.getActiveElement();\n  if (activeElement) {\n    activeElement.focus();\n  }\n\n  enableBodyScroll(globals.modalElem);\n}","import domReady from \"./dom-ready\";\nimport MiniEvents from \"./mini-events\";\n\nconst validDataEventTypes = [\"pageViews\", \"highestScrollPercentage\", \"activeTimeOnSite\", \"activeTimeOnPage\"];\nconst eventValueUnitLookup = {\n  pageViews: \"\",\n  highestScrollPercentage: \"%\",\n  activeTimeOnSite: \"s\",\n  activeTimeOnPage: \"s\"\n};\n\nconst debugNoticeHtml = `<div class=\"debug-emails-forms\">\n  <div>\n    <b>Page views: </b><span data-event-name=\"pageViews\">0</span>\n  </div>\n  <div>\n    <b>Scroll percentage: </b><span data-event-name=\"highestScrollPercentage\">0%</span>\n  </div>\n  <div>\n    <b>Time on site: </b><span data-event-name=\"activeTimeOnSite\">0s</span>\n  </div>\n  <div>\n    <b>Time on page: </b><span data-event-name=\"activeTimeOnPage\">0s</span>\n  </div>\n  <div>\n    <b>Saw modal: </b><span>never</span>\n  </div>\n  <div>\n    <b>Closed modal: </b><span>never</span>\n  </div>\n  <div>\n    <b>Closed bottom bar: </b><span>never</span>\n  </div>\n  <div>\n    <b>Modal is openable: </b><span data-event-name=\"modalIsOpenable\">false</span>\n  </div>\n  <button class=\"debug-emails-forms__reset\" type=\"button\">Reset</button>\n</div>`;\n\nexport default function initDebugNotice () {\n  MiniEvents.listen(\"pageData\", function (dataEvent) {\n    let eventName = validDataEventTypes.find(name => dataEvent.hasOwnProperty(name));\n    let eventValue = dataEvent[eventName] + eventValueUnitLookup[eventName];\n\n    let eventDebugElement = document.querySelector(`.debug-emails-forms [data-event-name='${eventName}']`);\n    eventDebugElement.innerText = eventValue;\n  });\n\n  MiniEvents.listen(\"MODAL_IS_OPENABLE\", function (isOpenable) {\n    let eventDebugElement = document.querySelector(`.debug-emails-forms [data-event-name='modalIsOpenable']`);\n    eventDebugElement.innerText = isOpenable ? \"true\" : \"false\";\n  });\n\n  domReady(function () {\n    document.body.insertAdjacentHTML(\"beforeend\", debugNoticeHtml);\n\n    // reset button\n    document.querySelector(\".debug-emails-forms__reset\").addEventListener(\"click\", e => {\n      window.localStorage.clear(); \n      window.location.reload();\n    });\n  });\n}","import throttle from \"./helpers/throttle\";\nimport db from \"./helpers/localstorage-db\";\nimport onExitIntent from \"./helpers/on-exit-intent\";\nimport globals from \"./helpers/globals\";\nimport initDataWatchers from \"./helpers/init-data-watchers\";\nimport initModalDataWatchers from \"./modal/init-modal-data-watchers\";\nimport initModal from \"./modal/init-modal\";\nimport initDebugNotice from \"./helpers/init-debug-notice\";\nimport openModal from \"./modal/open-modal\";\n\nexport default function initEmailForms ({\n  websiteType, // \"content\" or \"marketing\"\n  beSlightlyMoreAggressive = false,\n  onSubmit = () => {},\n  showDebugNotice = false,\n  imageSrc = \"\",\n  headingText = \"Sign up for updates\",\n  descriptionText = \"Get cutting edge articles and insights into our process\",\n  mainButtonText = \"Sign up\",\n  closeButtonText = \"Close\"\n}) {\n  if (showDebugNotice) {\n    initDebugNotice();\n  }\n\n  // add modal HTML to page and keep track of relevant modal elements\n  initModal({onSubmit, imageSrc, headingText, descriptionText, mainButtonText});\n\n  // keeps track of scroll position, page views, time on site, etc.\n  initDataWatchers();\n\n  // listens to page data and determines if modal is openable\n  initModalDataWatchers({websiteType, beSlightlyMoreAggressive});\n\n  onExitIntent(function () {\n    if (globals.isModalOpenable()) {\n      openModal({imageSrc, headingText, descriptionText, mainButtonText, closeButtonText});\n    }\n  });\n\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","/*\n  Exit Intent\n  ===========\n  Triggers a callback whenever the user is about to leave the page\n\n  - Isn't aggressive\n    - Will only trigger once\n    - Will only trigger when the mouse is near top of page\n  - Addresses Firefox bugs with INPUT and SELECT elements\n*/\n\nexport default function onExitIntent (exitIntentCallback) {\n  function onMouseOut(event) {\n    let mouseNearTopOfPage = event.clientY < 20;\n    let mouseDidntEnterAnotherElement = event.relatedTarget === null;\n    let mouseEventIsNotInsideAnInputElement = event.target.nodeName.toLowerCase() !== \"select\" && event.target.nodeName.toLowerCase() !== \"input\"; \n\n    if (mouseNearTopOfPage && mouseDidntEnterAnotherElement && mouseEventIsNotInsideAnInputElement) {\n      // document.removeEventListener(\"mouseout\", onMouseOut);\n      if (exitIntentCallback) {\n        exitIntentCallback();\n      }\n    }\n  }\n  document.addEventListener(\"mouseout\", onMouseOut);\n}","import globals from \"../helpers/globals\";\nimport getTemplateString from \"./get-template-string\";\nimport initModalEventListeners from \"./init-modal-event-listeners\";\n\nexport default function initModal ({onSubmit, imageSrc, headingText, descriptionText, mainButtonText}) {\n  // Insert modal HTML\n  let modalTemplateString = getTemplateString({imageSrc, headingText, descriptionText, mainButtonText});\n  document.body.insertAdjacentHTML(\"beforeend\", modalTemplateString);\n\n  // get modal elements\n  globals.modalElem = document.querySelector(globals.MODAL_ELEM_CLASS); // \"$('.some-class')\"\n  globals.modalElemForm = document.querySelector(globals.MODAL_ELEM_FORM_CLASS);\n  globals.modalElemCloseButton = document.querySelector(globals.MODAL_ELEM_CLOSE_BUTTON_CLASS);\n\n  // save onSubmit callback\n  globals.onSubmit = onSubmit;\n\n  initModalEventListeners();\n}","export default function getModalTemplateString ({imageSrc, headingText, descriptionText, mainButtonText}) {\n  return `\n<div class=\"email-modal\" role=\"dialog\" aria-labelledby=\"email-modal-title\" aria-describedby=\"email-modal-description\" aria-hidden=\"true\" style=\"display: none\">\n  <form class=\"email-modal__content\" method=\"POST\" action=\"/\">\n    <div class=\"email-modal__top\">\n      <div class=\"email-modal__top-media\">\n        <img class=\"email-modal__top-image\" src=\"${imageSrc}\">\n      </div>\n      <div class=\"email-modal__top-content\">\n        <h2 class=\"email-modal__title\" id=\"email-modal-title\">${headingText}</h2>\n        <p class=\"email-modal__description\" id=\"email-modal-description\">${descriptionText}</p>\n      </div>\n    </div>\n    <div class=\"email-modal__input-container\">\n      <input class=\"email-modal__input email-signup-form-input\" type=\"email\" value=\"\" placeholder=\"email@example.com\">\n    </div>\n    <div class=\"email-modal__button-container\">\n      <button class=\"email-modal__sign-up\" type=\"submit\">${mainButtonText}</button>\n    </div>\n    <button class=\"email-modal__close\" type=\"button\"></button>\n  </form>\n</div>\n`;\n}","import globals from \"../helpers/globals\";\nimport closeModal from \"./close-modal\";\n\nexport default function initModalEventListeners () {\n  globals.modalElem.addEventListener(\"click\", event => onClickModalBackdrop({event}));\n  globals.modalElemForm.addEventListener(\"submit\", event => onSubmit({event}));\n  globals.modalElemCloseButton.addEventListener('click', () => closeModal());\n  document.addEventListener(\"keydown\", (event) => onKeyDown({event}));\n}\n\nfunction onKeyDown ({event}) {\n  if (event.keyCode === 27 && document.body.classList.contains(globals.BODY_CLASS_MODAL_OPEN)) {\n    closeModal();\n  }\n}\n\nfunction onSubmit ({event}) {\n  event.preventDefault();\n\n  // trigger onSubmit callback\n  let emailInputElement = event.currentTarget.querySelector(\".email-signup-form-input\");\n  let email = emailInputElement.value;\n  globals.onSubmit({event, email});\n\n  closeModal();\n}\n\nfunction onClickModalBackdrop ({event}) {\n  if (!event.target.closest(globals.MODAL_ELEM_FORM_CLASS)) {\n    closeModal();\n  }\n}\n\n","import globals from \"../helpers/globals\";\nimport MiniEvents from \"../helpers/mini-events\";\nimport getTriggerOptions from \"./get-trigger-options\";\n\nexport default function initModalDataWatchers ({websiteType, beSlightlyMoreAggressive}) {\n  MiniEvents.listen(\"pageData\", function (dataEvent) {\n    let triggerOptions = getTriggerOptions({websiteType, beSlightlyMoreAggressive});\n\n    let shouldShowModal = Object.keys(triggerOptions).every(triggerOptionKey => {\n      let minValue = triggerOptions[triggerOptionKey];\n      let actualValue = globals[triggerOptionKey];\n\n      return actualValue >= minValue;\n    });;\n\n    if (shouldShowModal) {\n      globals.setModalAsOpenable();\n    }\n  });\n}","import globals from \"../helpers/globals\";\n\nexport default function ({websiteType, beSlightlyMoreAggressive}) {\n  if (websiteType === globals.WEBSITE_TYPES.CONTENT) {\n    if (!beSlightlyMoreAggressive) {\n      // not aggressive\n      return {\n        ACTIVE_TIME_ON_PAGE: 8,\n        ACTIVE_TIME_ON_SITE: 30,\n        HIGHEST_SCROLL_PERCENTAGE: 35\n      };\n    } else {\n      // somewhat aggressive\n      return {\n        ACTIVE_TIME_ON_PAGE: 6,\n        ACTIVE_TIME_ON_SITE: 20,\n        HIGHEST_SCROLL_PERCENTAGE: 25\n      };\n    }\n  } else if (websiteType === globals.WEBSITE_TYPES.MARKETING) {\n    if (!beSlightlyMoreAggressive) {\n      // not aggressive\n      return {\n        ACTIVE_TIME_ON_PAGE: 8,\n        SITE_PAGE_VIEWS: 3,\n        ACTIVE_TIME_ON_SITE: 30\n      };\n    } else {\n      // somewhat aggressive\n      return {\n        ACTIVE_TIME_ON_PAGE: 6,\n        SITE_PAGE_VIEWS: 2,\n        ACTIVE_TIME_ON_SITE: 20\n      };\n    }\n  }\n}","import globals from \"../helpers/globals\";\nimport { disableBodyScroll } from 'body-scroll-lock';\n\nexport default function openModal() {\n  globals.setActiveElement(document.activeElement);\n\n  // show the modal\n  globals.modalElem.style.display = 'flex';\n  document.body.classList.add(globals.BODY_CLASS_MODAL_OPEN);\n  \n  // Focus the first element within the modal. Make sure the element is visible and doesnt have focus disabled (tabindex=-1);\n  globals.modalElem.querySelector(globals.FOCUSABLE_SELECTORS).focus();\n\n  // Trap the tab focus by disable tabbing on all elements outside of your modal.\n  // These elements need to be gotten at the time the modal is opened because they may have been added to the page dynamically\n  const focusableElements = document.querySelectorAll(globals.FOCUSABLE_SELECTORS);\n  const focusableElementsInModal = globals.modalElem.querySelectorAll(globals.FOCUSABLE_SELECTORS);\n  const focusableElementsInModalArray = Array.from(focusableElementsInModal);\n  focusableElements.forEach(el => {\n    if (!focusableElementsInModalArray.includes(el)) {\n      el.setAttribute('tabindex', '-1');\n    }\n  });\n\n  // Trap the screen reader focus as well with aria roles.\n  globals.modalElem.removeAttribute('aria-hidden');\n  const topLevelElements = Array.from(document.body.children);\n  topLevelElements.forEach(el => {\n    if (el !== globals.modalElem) {\n      el.setAttribute('aria-hidden', 'true');\n    }\n  });\n\n  disableBodyScroll(globals.modalElem);\n}","import initEmailForms from \"./init-email-forms\";\nimport globals from \"./helpers/globals\";\n\nfunction contentWebsite (options) {\n  options.websiteType = globals.WEBSITE_TYPES.CONTENT;\n  initEmailForms(options);\n}\n\nfunction marketingWebsite (options) {\n  options.websiteType = globals.WEBSITE_TYPES.MARKETING;\n  initEmailForms(options);\n}\n\nexport default {\n  contentWebsite,\n  marketingWebsite\n}"],"names":["set","itemName","itemValue","databaseString","localStorage","getItem","databaseObject","JSON","parse","setItem","stringify","get","increment","num","name","value","event","CustomEvent","detail","document","dispatchEvent","cb","addEventListener","WEBSITE_TYPES","CONTENT","MARKETING","FOCUSABLE_SELECTORS","IS_MOBILE","window","matchMedia","matches","MODAL_ELEM_CLASS","MODAL_ELEM_FORM_CLASS","MODAL_ELEM_CLOSE_BUTTON_CLASS","BODY_CLASS_MODAL_OPEN","MODAL_IS_OPENABLE","SITE_PAGE_VIEWS","HIGHEST_SCROLL_PERCENTAGE","ACTIVE_TIME_ON_SITE","ACTIVE_TIME_ON_PAGE","setActiveElement","el","this","activeElement","getActiveElement","setModalAsOpenable","MiniEvents","isModalOpenable","getHighestScrollPercentage","getActiveTimeOnSite","getActiveTimeOnPage","incrementSitePageViews","pageViews","db","setHighestScrollPercentage","savedScrollPercentage","highestScrollPercentage","incrementActiveTimeOnSite","seconds","activeTimeOnSite","incrementActiveTimeOnPage","activeTimeOnPage","domReady","fn","readyState","setCurrentScrollPercentageThrottled","delay","noTrailing","callback","debounceMode","timeoutID","cancelled","lastExec","clearExistingTimeout","clearTimeout","wrapper","self","elapsed","Date","now","args","arguments","exec","apply","clear","undefined","setTimeout","cancel","throttle","globals","docScrollHeight","Math","max","body","scrollHeight","documentElement","offsetHeight","clientHeight","scrollPercentage","pageYOffset","floor","getScrollPercentage","_toConsumableArray","arr","Array","isArray","i","arr2","length","from","hasPassiveEvents","passiveTestOptions","passive","removeEventListener","isIosDevice","navigator","platform","test","maxTouchPoints","locks","documentListenerAdded","initialClientY","previousBodyOverflowSetting","previousBodyPaddingRight","allowTouchMove","some","lock","options","preventDefault","rawEvent","e","target","touches","closeModal","classList","remove","modalElem","style","display","querySelectorAll","forEach","removeAttribute","setAttribute","focus","targetElement","console","error","ontouchstart","ontouchmove","filter","paddingRight","overflow","enableBodyScroll","validDataEventTypes","eventValueUnitLookup","initEmailForms","websiteType","beSlightlyMoreAggressive","onSubmit","showDebugNotice","imageSrc","headingText","descriptionText","mainButtonText","closeButtonText","exitIntentCallback","dataEvent","eventName","find","hasOwnProperty","eventValue","querySelector","innerText","isOpenable","insertAdjacentHTML","location","reload","modalTemplateString","getTemplateString","modalElemForm","modalElemCloseButton","closest","onClickModalBackdrop","emailInputElement","currentTarget","email","keyCode","contains","onKeyDown","initModal","triggerOptions","getTriggerOptions","Object","keys","every","triggerOptionKey","initModalDataWatchers","add","focusableElements","focusableElementsInModal","focusableElementsInModalArray","includes","children","concat","targetTouches","clientY","scrollTop","isTargetElementTotallyScrolled","stopPropagation","handleScroll","_lock","disableBodyScroll","openModal","mouseNearTopOfPage","mouseDidntEnterAnotherElement","relatedTarget","mouseEventIsNotInsideAnInputElement","nodeName","toLowerCase","contentWebsite","marketingWebsite"],"mappings":"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"}