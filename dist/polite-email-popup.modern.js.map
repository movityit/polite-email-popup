{"version":3,"file":"polite-email-popup.modern.js","sources":["../../tigerlily/dist/tigerlily.module.js","../src/persistent-globals/persistent-globals.js","../src/temporary-globals/temporary-globals.js","../src/trigger-popups/meets-trigger-requirements.js","../src/dom/get-elem.js","../src/dom/add-html-to-page.js","../node_modules/body-scroll-lock/lib/bodyScrollLock.mjs","../src/modal/modal-actions/close-modal.js","../src/init-email-forms.js","../src/dom/dom-ready.js","../src/helpers/on-exit-intent.js","../src/trigger-popups/watch-trigger-data.js","../src/temporary-globals/init-temporary-globals.js","../src/persistent-globals/init-persistent-globals.js","../node_modules/stormcloud/dist/stormcloud.module.js","../src/dom/init-dom-elements.js","../src/debug-notice/get-debug-notice-template-string.js","../src/modal/get-modal-template-string.js","../src/bottom-bar/get-bottom-bar-template-string.js","../src/dom/init-elem-globals.js","../src/debug-notice/init-debug-notice-event-listeners.js","../src/modal/init-exit-intent.js","../src/modal/modal-actions/open-modal.js","../src/modal/init-modal-event-listeners.js","../src/helpers/globals.js","../src/index.js"],"sourcesContent":["var t,n,r=Object.prototype,e=Function.prototype.toString,o=r.hasOwnProperty,a=e.call(Object),i=r.toString,u=(t=Object.getPrototypeOf,n=Object,function(r){return t(n(r))});function c(t,n){(null==n||n>t.length)&&(n=t.length);for(var r=0,e=new Array(n);r<n;r++)e[r]=t[r];return e}function l(t,n){var r;if(\"undefined\"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(r=function(t,n){if(t){if(\"string\"==typeof t)return c(t,void 0);var r=Object.prototype.toString.call(t).slice(8,-1);return\"Object\"===r&&t.constructor&&(r=t.constructor.name),\"Map\"===r||\"Set\"===r?Array.from(t):\"Arguments\"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?c(t,void 0):void 0}}(t))||n&&t&&\"number\"==typeof t.length){r&&(t=r);var e=0;return function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}return(r=t[Symbol.iterator]()).next.bind(r)}function f(){this.callbacksLookup={}}f.prototype={emit:function(t,n){for(var r,e=this.callbacksLookup[\"*\"]||[],o=l(this.callbacksLookup[t]||[]);!(r=o()).done;)(0,r.value)({name:t,value:n});for(var a,i=l(e);!(a=i()).done;)(0,a.value)({name:t,value:n})},on:function(t,n){for(var r,e=l(Array.isArray(t)?t:[t]);!(r=e()).done;){var o=r.value;this.callbacksLookup[o]||(this.callbacksLookup[o]=[]),this.callbacksLookup[o].push(n)}}};var s=new f;function p(t,n){void 0===n&&(n={}),t=t||\"tigerlily\";var r=n.defaults,c=void 0===r?{}:r,l=JSON.parse(localStorage.getItem(t)||\"{}\",b);return l=Object.assign(c,l),new Proxy(l,function n(r){return{get:function(t,e){return y(t[e])?new Proxy(t[e],n(r)):t[e]},set:function(n,c,l){n[c]=l,localStorage.setItem(t,JSON.stringify(r,v));var f=n[c],p=y(f)?JSON.parse(JSON.stringify(f,v),b):f,d=y(l)?JSON.parse(JSON.stringify(l,v),b):l,g=function(t,n){if(t===n)return\"\";var r=\"\";return function t(n,r,c){c=c||\"\",Array.isArray(n)?function(n,r,e){n.forEach((n,o,a)=>{const i=`${e}[${o}]`;r.call(a,n,o,a,i),t(a[o],r,i)})}(n,r,c):function(t){if(!function(t){return!!t&&\"object\"==typeof t}(t)||\"[object Object]\"!=i.call(t)||function(t){var n=!1;if(null!=t&&\"function\"!=typeof t.toString)try{n=!!(t+\"\")}catch(t){}return n}(t))return!1;var n=u(t);if(null===n)return!0;var r=o.call(n,\"constructor\")&&n.constructor;return\"function\"==typeof r&&r instanceof r&&e.call(r)==a}(n)&&function(n,r,e){for(const o in n){const a=e?`${e}.${o}`:o;r.call(n,n[o],o,n,a),t(n[o],r,a)}}(n,r,c)}(t,function(t,e,o,a){t===n&&(r=a)}),r}(r,l)||c;return s.emit(g,{prop:c,path:g,oldValue:p,value:d}),!0}}}(l))}function y(t){return\"object\"==typeof t&&null!==t&&!(t instanceof Date)}function v(t,n){if(this[t]instanceof Date){var r=this[t].getTime();return r?{__isDate:!0,ms:r}:void 0}return n}function b(t,n){return y(n)&&n.__isDate?new Date(n.ms):n}p.on=function(t,n){s.on(t,function(t){n(t.value)})};export default p;\n//# sourceMappingURL=tigerlily.module.js.map\n","import tigerlily from \"tigerlily\";\n\nlet persistentGlobals;\n\nif (!persistentGlobals) {\n  persistentGlobals = tigerlily('polite-email-popup');\n}\n\nwindow.persistentGlobals = persistentGlobals; // todo remove\n\nexport {tigerlily, persistentGlobals};","export default {};","import {persistentGlobals} from \"../persistent-globals/persistent-globals\";\nimport temporaryGlobals from \"../temporary-globals/temporary-globals\";\n\nconst minimumsLookup = {\n  \"pageViews\": {\n    \"content\": {\n      \"notAggressive\": 0,\n      \"aggressive\": 0\n    },\n    \"marketing\": {\n      \"notAggressive\": 3,\n      \"aggressive\": 2\n    }\n  },\n  \"activeTimeOnPage\": {\n    \"content\": {\n      \"notAggressive\": 8,\n      \"aggressive\": 6\n    },\n    \"marketing\": {\n      \"notAggressive\": 8,\n      \"aggressive\": 6\n    }\n  },\n  \"activeTimeOnSite\": {\n    \"content\": {\n      \"notAggressive\": 30,\n      \"aggressive\": 20\n    },\n    \"marketing\": {\n      \"notAggressive\": 30,\n      \"aggressive\": 20\n    }\n  },\n  \"highestScrollPercentageAcrossAllPages\": {\n    \"content\": {\n      \"notAggressive\": 35,\n      \"aggressive\": 25\n    },\n    \"marketing\": {\n      \"notAggressive\": 0,\n      \"aggressive\": 0\n    }\n  }\n}\n\nexport default function meetsTriggerRequirements () {\n  let websiteType = temporaryGlobals.websiteType;\n  let aggressive = temporaryGlobals.beSlightlyMoreAggressive ? \"aggressive\" : \"notAggressive\";\n\n  const minimums = {\n    pageViews: minimumsLookup[\"pageViews\"][websiteType][aggressive],\n    activeTimeOnPage: minimumsLookup[\"activeTimeOnPage\"][websiteType][aggressive],\n    activeTimeOnSite: minimumsLookup[\"activeTimeOnSite\"][websiteType][aggressive],\n    highestScrollPercentageAcrossAllPages: minimumsLookup[\"highestScrollPercentageAcrossAllPages\"][websiteType][aggressive]\n  }\n\n  console.log({minimums});\n\n}\n\n\n\n\n\n","let cache = {};\n// caches result of getting an element\nexport default function getElem (selector) {\n  return cache[selector] || document.querySelector(selector);\n}","export default function addHtmlToPage (htmlString) {\n  document.body.insertAdjacentHTML(\"beforeend\", htmlString);\n}","function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\n// Older browsers don't support event options, feature detect it.\n\n// Adopted and modified solution from Bohdan Didukh (2017)\n// https://stackoverflow.com/questions/41594997/ios-10-safari-prevent-scrolling-behind-a-fixed-overlay-and-maintain-scroll-posi\n\nvar hasPassiveEvents = false;\nif (typeof window !== 'undefined') {\n  var passiveTestOptions = {\n    get passive() {\n      hasPassiveEvents = true;\n      return undefined;\n    }\n  };\n  window.addEventListener('testPassive', null, passiveTestOptions);\n  window.removeEventListener('testPassive', null, passiveTestOptions);\n}\n\nvar isIosDevice = typeof window !== 'undefined' && window.navigator && window.navigator.platform && (/iP(ad|hone|od)/.test(window.navigator.platform) || window.navigator.platform === 'MacIntel' && window.navigator.maxTouchPoints > 1);\n\n\nvar locks = [];\nvar documentListenerAdded = false;\nvar initialClientY = -1;\nvar previousBodyOverflowSetting = void 0;\nvar previousBodyPaddingRight = void 0;\n\n// returns true if `el` should be allowed to receive touchmove events.\nvar allowTouchMove = function allowTouchMove(el) {\n  return locks.some(function (lock) {\n    if (lock.options.allowTouchMove && lock.options.allowTouchMove(el)) {\n      return true;\n    }\n\n    return false;\n  });\n};\n\nvar preventDefault = function preventDefault(rawEvent) {\n  var e = rawEvent || window.event;\n\n  // For the case whereby consumers adds a touchmove event listener to document.\n  // Recall that we do document.addEventListener('touchmove', preventDefault, { passive: false })\n  // in disableBodyScroll - so if we provide this opportunity to allowTouchMove, then\n  // the touchmove event on document will break.\n  if (allowTouchMove(e.target)) {\n    return true;\n  }\n\n  // Do not prevent if the event has more than one touch (usually meaning this is a multi touch gesture like pinch to zoom).\n  if (e.touches.length > 1) return true;\n\n  if (e.preventDefault) e.preventDefault();\n\n  return false;\n};\n\nvar setOverflowHidden = function setOverflowHidden(options) {\n  // Setting overflow on body/documentElement synchronously in Desktop Safari slows down\n  // the responsiveness for some reason. Setting within a setTimeout fixes this.\n  setTimeout(function () {\n    // If previousBodyPaddingRight is already set, don't set it again.\n    if (previousBodyPaddingRight === undefined) {\n      var _reserveScrollBarGap = !!options && options.reserveScrollBarGap === true;\n      var scrollBarGap = window.innerWidth - document.documentElement.clientWidth;\n\n      if (_reserveScrollBarGap && scrollBarGap > 0) {\n        previousBodyPaddingRight = document.body.style.paddingRight;\n        document.body.style.paddingRight = scrollBarGap + 'px';\n      }\n    }\n\n    // If previousBodyOverflowSetting is already set, don't set it again.\n    if (previousBodyOverflowSetting === undefined) {\n      previousBodyOverflowSetting = document.body.style.overflow;\n      document.body.style.overflow = 'hidden';\n    }\n  });\n};\n\nvar restoreOverflowSetting = function restoreOverflowSetting() {\n  // Setting overflow on body/documentElement synchronously in Desktop Safari slows down\n  // the responsiveness for some reason. Setting within a setTimeout fixes this.\n  setTimeout(function () {\n    if (previousBodyPaddingRight !== undefined) {\n      document.body.style.paddingRight = previousBodyPaddingRight;\n\n      // Restore previousBodyPaddingRight to undefined so setOverflowHidden knows it\n      // can be set again.\n      previousBodyPaddingRight = undefined;\n    }\n\n    if (previousBodyOverflowSetting !== undefined) {\n      document.body.style.overflow = previousBodyOverflowSetting;\n\n      // Restore previousBodyOverflowSetting to undefined\n      // so setOverflowHidden knows it can be set again.\n      previousBodyOverflowSetting = undefined;\n    }\n  });\n};\n\n// https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollHeight#Problems_and_solutions\nvar isTargetElementTotallyScrolled = function isTargetElementTotallyScrolled(targetElement) {\n  return targetElement ? targetElement.scrollHeight - targetElement.scrollTop <= targetElement.clientHeight : false;\n};\n\nvar handleScroll = function handleScroll(event, targetElement) {\n  var clientY = event.targetTouches[0].clientY - initialClientY;\n\n  if (allowTouchMove(event.target)) {\n    return false;\n  }\n\n  if (targetElement && targetElement.scrollTop === 0 && clientY > 0) {\n    // element is at the top of its scroll.\n    return preventDefault(event);\n  }\n\n  if (isTargetElementTotallyScrolled(targetElement) && clientY < 0) {\n    // element is at the bottom of its scroll.\n    return preventDefault(event);\n  }\n\n  event.stopPropagation();\n  return true;\n};\n\nexport var disableBodyScroll = function disableBodyScroll(targetElement, options) {\n  if (isIosDevice) {\n    // targetElement must be provided, and disableBodyScroll must not have been\n    // called on this targetElement before.\n    if (!targetElement) {\n      // eslint-disable-next-line no-console\n      console.error('disableBodyScroll unsuccessful - targetElement must be provided when calling disableBodyScroll on IOS devices.');\n      return;\n    }\n\n    if (targetElement && !locks.some(function (lock) {\n      return lock.targetElement === targetElement;\n    })) {\n      var lock = {\n        targetElement: targetElement,\n        options: options || {}\n      };\n\n      locks = [].concat(_toConsumableArray(locks), [lock]);\n\n      targetElement.ontouchstart = function (event) {\n        if (event.targetTouches.length === 1) {\n          // detect single touch.\n          initialClientY = event.targetTouches[0].clientY;\n        }\n      };\n      targetElement.ontouchmove = function (event) {\n        if (event.targetTouches.length === 1) {\n          // detect single touch.\n          handleScroll(event, targetElement);\n        }\n      };\n\n      if (!documentListenerAdded) {\n        document.addEventListener('touchmove', preventDefault, hasPassiveEvents ? { passive: false } : undefined);\n        documentListenerAdded = true;\n      }\n    }\n  } else {\n    setOverflowHidden(options);\n    var _lock = {\n      targetElement: targetElement,\n      options: options || {}\n    };\n\n    locks = [].concat(_toConsumableArray(locks), [_lock]);\n  }\n};\n\nexport var clearAllBodyScrollLocks = function clearAllBodyScrollLocks() {\n  if (isIosDevice) {\n    // Clear all locks ontouchstart/ontouchmove handlers, and the references.\n    locks.forEach(function (lock) {\n      lock.targetElement.ontouchstart = null;\n      lock.targetElement.ontouchmove = null;\n    });\n\n    if (documentListenerAdded) {\n      document.removeEventListener('touchmove', preventDefault, hasPassiveEvents ? { passive: false } : undefined);\n      documentListenerAdded = false;\n    }\n\n    locks = [];\n\n    // Reset initial clientY.\n    initialClientY = -1;\n  } else {\n    restoreOverflowSetting();\n    locks = [];\n  }\n};\n\nexport var enableBodyScroll = function enableBodyScroll(targetElement) {\n  if (isIosDevice) {\n    if (!targetElement) {\n      // eslint-disable-next-line no-console\n      console.error('enableBodyScroll unsuccessful - targetElement must be provided when calling enableBodyScroll on IOS devices.');\n      return;\n    }\n\n    targetElement.ontouchstart = null;\n    targetElement.ontouchmove = null;\n\n    locks = locks.filter(function (lock) {\n      return lock.targetElement !== targetElement;\n    });\n\n    if (documentListenerAdded && locks.length === 0) {\n      document.removeEventListener('touchmove', preventDefault, hasPassiveEvents ? { passive: false } : undefined);\n\n      documentListenerAdded = false;\n    }\n  } else {\n    locks = locks.filter(function (lock) {\n      return lock.targetElement !== targetElement;\n    });\n    if (!locks.length) {\n      restoreOverflowSetting();\n    }\n  }\n};\n\n","import { enableBodyScroll } from 'body-scroll-lock';\nimport temporaryGlobals from \"../../temporary-globals/temporary-globals\";\n\nexport default function closeModal() {\n  document.body.classList.remove(temporaryGlobals.BODY_CLASS_MODAL_OPEN);\n\n  // TODO: keep track of when the modal was closed\n  // setItemLocalStorage(\"modalClosedDate\", Date.now());\n\n  // hide the modal\n  temporaryGlobals.MODAL_ELEM.style.display = 'none';\n\n  // Untrap the tab focus by removing tabindex=-1. You should restore previous values if an element had them.    \n  const focusableElements = document.querySelectorAll(temporaryGlobals.FOCUSABLE_SELECTORS);\n  focusableElements.forEach(el => el.removeAttribute('tabindex'));\n  \n  // Untrap screen reader focus\n  const topLevelElements = document.querySelectorAll(\"body > [aria-hidden]\");\n  topLevelElements.forEach(el => el.removeAttribute('aria-hidden'));\n  temporaryGlobals.MODAL_ELEM.setAttribute('aria-hidden', 'true');\n  \n  // restore focus to the triggering element\n  if (temporaryGlobals.activeElement) {\n    temporaryGlobals.activeElement.focus();\n  }\n\n  enableBodyScroll(temporaryGlobals.MODAL_ELEM);\n}","import domReady from \"./dom/dom-ready\";\n\nimport watchTriggerData from \"./trigger-popups/watch-trigger-data\";\nimport initTemporaryGlobals from \"./temporary-globals/init-temporary-globals\";\nimport initPersistentGlobals from \"./persistent-globals/init-persistent-globals\";\nimport initDomElements from \"./dom/init-dom-elements\";\n\nimport initDebugNotice from \"./debug-notice/init-debug-notice\";\nimport initModal from \"./modal/init-modal\";\n\n\n\n// import initDataWatchers from \"./helpers/init-data-watchers\";\n// import initModalDataWatchers from \"./modal/init-modal-data-watchers\";\n// import initModal from \"./modal/init-modal\";\n\nexport default function initEmailForms (options) {\n  domReady(() => {\n\n    // trigger the popups when data is right\n    watchTriggerData();\n\n    // set up all global options and elements we'll need\n    initTemporaryGlobals(options);\n\n    // set up global options that need to persist through page loads (e.g. page views, scroll percentage, active time on site)\n    initPersistentGlobals();\n\n    // add debug notice, modal, and bottom bar to the page\n    initDomElements();\n\n    // show a debug notice to keep track of triggers and user engagement\n    initDebugNotice();\n\n    // set up event listeners for email popup\n    initModal();\n\n  });\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","export default function domReady(fn) {\n  if (document.readyState != 'loading'){\n    fn();\n  } else {\n    document.addEventListener('DOMContentLoaded', fn);\n  }\n}","/*\n  Exit Intent\n  ===========\n  Triggers a callback whenever the user is about to leave the page\n\n  - Isn't aggressive\n    - Will only trigger once\n    - Will only trigger when the mouse is near top of page\n  - Addresses Firefox bugs with INPUT and SELECT elements\n*/\n\nexport default function onExitIntent (exitIntentCallback) {\n  function onMouseOut(event) {\n    let mouseNearTopOfPage = event.clientY < 20;\n    let mouseDidntEnterAnotherElement = event.relatedTarget === null;\n    let mouseEventIsNotInsideAnInputElement = event.target.nodeName.toLowerCase() !== \"select\" && event.target.nodeName.toLowerCase() !== \"input\"; \n\n    if (mouseNearTopOfPage && mouseDidntEnterAnotherElement && mouseEventIsNotInsideAnInputElement) {\n      // document.removeEventListener(\"mouseout\", onMouseOut);\n      if (exitIntentCallback) {\n        exitIntentCallback();\n      }\n    }\n  }\n  document.addEventListener(\"mouseout\", onMouseOut);\n}","import {tigerlily} from \"../persistent-globals/persistent-globals\";\nimport meetsTriggerRequirements from \"./meets-trigger-requirements\";\n\nexport default function watchTriggerData () {\n  tigerlily.on(\"*\", function ({prop, path, oldValue, value}) {\n    console.log(\"*\", {prop, path, oldValue, value});\n    console.log({meetsTriggerRequirements: meetsTriggerRequirements()});\n  });\n}","import temporaryGlobals from \"./temporary-globals\";\nimport getElem from \"../dom/get-elem\";\n\nexport default function initTemporaryGlobals (userDefinedGlobals) {\n  const SELECTORS = {\n    MODAL_ELEM_SELECTOR: \".email-modal\",\n    MODAL_FORM_ELEM_SELECTOR: \".email-modal__content\",\n    MODAL_FORM_INPUT_ELEM_SELECTOR: \".email-signup-form-input\",\n    MODAL_CLOSE_BUTTON_ELEM_SELECTOR: \".email-modal__close\",\n    DEBUG_ELEM_RESET_SELECTOR: \".debug-emails-forms__reset\"\n  };\n\n  const defaultGlobals = {\n    \n    // USER DEFAULTS\n    showDebugNotice: false,\n    websiteType: \"content\", // \"content\" or \"marketing\"\n    beSlightlyMoreAggressive: false,\n    onSubmit: () => {console.log(\"Event: Email form submitted\")},\n    imageSrc: \"\",\n    headingText: \"Sign up for updates\",\n    descriptionText: \"Get cutting edge articles and insights into our process\",\n    mainButtonText: \"Sign up\",\n    closeButtonText: \"Close\",\n\n    // SYSTEM GLOBALS\n    SELECTORS: SELECTORS,\n    IS_MOBILE: window.matchMedia(\"only screen and (max-width: 780px)\").matches,\n    FOCUSABLE_SELECTORS: 'a[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), *[tabindex]',\n    BODY_CLASS_MODAL_OPEN: 'email-modal-is-open',\n\n    // SYSTEM GLOBALS - DEBUG NOTICE\n    DEBUG_UNIT_PAGE_VIEWS: \"\",\n    DEBUG_UNIT_HIGHEST_SCROLL_PERCENTAGE: \"%\",\n    DEBUG_UNIT_ACTIVE_TIME_ON_SITE: \"s\",\n    DEBUG_UNIT_ACTIVE_TIME_ON_PAGE: \"s\"\n  };\n\n  Object.assign(temporaryGlobals, defaultGlobals, userDefinedGlobals);\n\n  temporaryGlobals.websiteType = temporaryGlobals.websiteType.toLowerCase();\n\n  if (temporaryGlobals.websiteType !== \"content\" && temporaryGlobals.websiteType !== \"marketing\") {\n    throw Error(\"websiteType must be set to either 'content' or 'marketing'\");\n  }\n\n  // todo remove\n  window.temporaryGlobals = temporaryGlobals;\n}\n\n\n","import {throttle} from \"stormcloud\";\nimport {persistentGlobals} from \"./persistent-globals\";\n\n/*\n\n  Keep track of:\n  - pageViews\n  - activeTimeOnPage\n  - activeTimeOnSite\n  - highestScrollPercentageAcrossAllPages\n\n*/ \nexport default function initPersistentGlobals (allOptions) {\n  if (typeof persistentGlobals.pageViews !== \"number\" || Number.isNaN(persistentGlobals.pageViews)) {\n    persistentGlobals.pageViews = 1;\n  } else {\n    persistentGlobals.pageViews++;\n  }\n\n  persistentGlobals.activeTimeOnPage = 0;\n\n  watchCurrentScrollPercentage();\n}\n\nfunction watchCurrentScrollPercentage () {\n  window.addEventListener('scroll', throttle(function () {\n    // will execute once for every second the user is scrolling\n    setHighestScrollPercentage();\n    persistentGlobals.activeTimeOnPage++;\n    persistentGlobals.activeTimeOnSite++;\n  }, 1000));\n}\n\nfunction setHighestScrollPercentage () {\n  let currentScrollPercentage = getScrollPercentage();\n  if (currentScrollPercentage > persistentGlobals.highestScrollPercentageAcrossAllPages) {\n    persistentGlobals.highestScrollPercentageAcrossAllPages = currentScrollPercentage;\n  }\n}\n\nfunction getScrollPercentage () {\n  // get the scroll height of the document (https://javascript.info/size-and-scroll-window#width-height-of-the-document) \n  let docScrollHeight = Math.max(document.body.scrollHeight, document.documentElement.scrollHeight, document.body.offsetHeight, document.documentElement.offsetHeight, document.body.clientHeight, document.documentElement.clientHeight);\n  // calculate scroll percentage (subtract browser height since that's not actually scrollable)\n  let scrollPercentage = window.pageYOffset / (docScrollHeight - document.documentElement.clientHeight);\n  // calculate percentage\n  return Math.floor(scrollPercentage * 100);\n}\n\n\n\n","function n(n,t){var i=!0,o=!1;return function(){var c=arguments;o||(o=!0,setTimeout(function(){n.apply(void 0,[].slice.call(c)),o=!1},i?0:t),i=!1)}}function t(n,t){var i;return function(){var o=arguments;clearTimeout(i),i=setTimeout(function(){n.apply(void 0,[].slice.call(o))},t)}}export{t as debounce,n as throttle};\n//# sourceMappingURL=stormcloud.module.js.map\n","import temporaryGlobals from \"../temporary-globals/temporary-globals\";\nimport addHtmlToPage from \"./add-html-to-page\";\nimport getDebugNoticeTemplateString from \"../debug-notice/get-debug-notice-template-string\";\nimport getModalTemplateString from \"../modal/get-modal-template-string\";\nimport getBottomBarTemplateString from \"../bottom-bar/get-bottom-bar-template-string\";\nimport initElemGlobals from \"./init-elem-globals\";\n\nexport default function initDomElements () {\n  if (temporaryGlobals.showDebugNotice) {\n    addHtmlToPage(getDebugNoticeTemplateString());\n  }\n\n  // Add modal to page\n  addHtmlToPage(getModalTemplateString(temporaryGlobals));\n\n  // Add bottom bar to page\n  addHtmlToPage(getBottomBarTemplateString(temporaryGlobals));\n\n  // Add elements to temporary globals\n  initElemGlobals();\n}","export default function addDebugNoticeHTMLToPage () {\n  return `<div class=\"debug-emails-forms\">\n    <div>\n      <b>Page views: </b><span data-event-name=\"pageViews\">0</span>\n    </div>\n    <div>\n      <b>Scroll percentage: </b><span data-event-name=\"highestScrollPercentage\">0%</span>\n    </div>\n    <div>\n      <b>Time on site: </b><span data-event-name=\"activeTimeOnSite\">0s</span>\n    </div>\n    <div>\n      <b>Time on page: </b><span data-event-name=\"activeTimeOnPage\">0s</span>\n    </div>\n    <div>\n      <b>Saw modal: </b><span>never</span>\n    </div>\n    <div>\n      <b>Closed modal: </b><span>never</span>\n    </div>\n    <div>\n      <b>Closed bottom bar: </b><span>never</span>\n    </div>\n    <div>\n      <b>Modal is openable: </b><span data-event-name=\"modalIsOpenable\">false</span>\n    </div>\n    <button class=\"debug-emails-forms__reset\" type=\"button\">Reset</button>\n  </div>`;\n}","export default function getModalTemplateString ({imageSrc, headingText, descriptionText, mainButtonText}) {\n  return `\n<div class=\"email-modal\" role=\"dialog\" aria-labelledby=\"email-modal-title\" aria-describedby=\"email-modal-description\" aria-hidden=\"true\" style=\"display: none\">\n  <form class=\"email-modal__content\" method=\"POST\" action=\"/\">\n    <div class=\"email-modal__top\">\n      <div class=\"email-modal__top-media\">\n        <img class=\"email-modal__top-image\" src=\"${imageSrc}\">\n      </div>\n      <div class=\"email-modal__top-content\">\n        <h2 class=\"email-modal__title\" id=\"email-modal-title\">${headingText}</h2>\n        <p class=\"email-modal__description\" id=\"email-modal-description\">${descriptionText}</p>\n      </div>\n    </div>\n    <div class=\"email-modal__input-container\">\n      <input class=\"email-modal__input email-signup-form-input\" type=\"email\" value=\"\" placeholder=\"email@example.com\">\n    </div>\n    <div class=\"email-modal__button-container\">\n      <button class=\"email-modal__sign-up\" type=\"submit\">${mainButtonText}</button>\n    </div>\n    <button class=\"email-modal__close\" type=\"button\"></button>\n  </form>\n</div>\n`;\n}","export default function getBottomBarTemplateString ({headingText, mainButtonText, closeButtonText}) {\n  return `<div class=\"bottom-bar\">\n  <form class=\"bottom-bar__content\" method=\"POST\" action=\"/\">\n    <label class=\"bottom-bar__label\">\n      <span class=\"bottom-bar__label-text\">${headingText}</span>\n      <input class=\"bottom-bar__input email-signup-form-input\" type=\"email\" value=\"\" placeholder=\"you@example.com\">\n    </label>\n    <button class=\"bottom-bar__sign-up\" type=\"submit\">${mainButtonText}</button>\n  </form>\n  <div class=\"bottom-bar__close-container\">\n    <button class=\"bottom-bar__close\" type=\"button\">${closeButtonText}</button>\n  </div>\n</div>`;\n}","import temporaryGlobals from \"../temporary-globals/temporary-globals\";\nimport getElem from \"./get-elem\";\n\nexport default function initElemGlobals () {\n  let {SELECTORS} = temporaryGlobals;\n\n  Object.assign(temporaryGlobals, {\n    MODAL_ELEM: getElem(SELECTORS.MODAL_ELEM_SELECTOR),\n    MODAL_FORM_ELEM: getElem(SELECTORS.MODAL_FORM_ELEM_SELECTOR),\n    MODAL_CLOSE_BUTTON_ELEM: getElem(SELECTORS.MODAL_CLOSE_BUTTON_ELEM_SELECTOR),\n    DEBUG_RESET_ELEM: getElem(SELECTORS.DEBUG_ELEM_RESET_SELECTOR)\n  });\n}","import temporaryGlobals from \"../temporary-globals/temporary-globals\";\n\nexport default function initDebugNoticeEventListeners () {\n  if (temporaryGlobals.showDebugNotice) {\n    temporaryGlobals.DEBUG_RESET_ELEM.addEventListener(\"click\", e => {\n      window.localStorage.clear(); \n      window.location.reload();\n    });\n  }\n}","import {persistentGlobals} from \"../persistent-globals/persistent-globals\";\nimport onExitIntent from \"../helpers/on-exit-intent\";\nimport openModal from \"./modal-actions/open-modal\";\n\n\n// adds exit intent event listener\nexport default function initExitIntent () {\n  onExitIntent(() => {\n    if (persistentGlobals.isModalOpenable) {\n      openModal();\n    }\n  });\n}","import temporaryGlobals from \"../../temporary-globals/temporary-globals\";\nimport { disableBodyScroll } from 'body-scroll-lock';\n\nexport default function openModal() {\n  temporaryGlobals.activeElement = document.activeElement;\n\n  // show the modal\n  temporaryGlobals.MODAL_ELEM.style.display = 'flex';\n  document.body.classList.add(temporaryGlobals.BODY_CLASS_MODAL_OPEN);\n  \n  // Focus the first element within the modal. Make sure the element is visible and doesnt have focus disabled (tabindex=-1);\n  temporaryGlobals.MODAL_ELEM.querySelector(temporaryGlobals.FOCUSABLE_SELECTORS).focus();\n\n  // Trap the tab focus by disable tabbing on all elements outside of your modal.\n  // These elements need to be gotten at the time the modal is opened because they may have been added to the page dynamically\n  const focusableElements = document.querySelectorAll(temporaryGlobals.FOCUSABLE_SELECTORS);\n  const focusableElementsInModal = globals.modalElem.querySelectorAll(temporaryGlobals.FOCUSABLE_SELECTORS);\n  const focusableElementsInModalArray = Array.from(focusableElementsInModal);\n  focusableElements.forEach(el => {\n    if (!focusableElementsInModalArray.includes(el)) {\n      el.setAttribute('tabindex', '-1');\n    }\n  });\n\n  // Trap the screen reader focus as well with aria roles.\n  temporaryGlobals.MODAL_ELEM.removeAttribute('aria-hidden');\n  const topLevelElements = Array.from(document.body.children);\n  topLevelElements.forEach(el => {\n    if (el !== temporaryGlobals.MODAL_ELEM) {\n      el.setAttribute('aria-hidden', 'true');\n    }\n  });\n\n  disableBodyScroll(temporaryGlobals.MODAL_ELEM);\n}","import temporaryGlobals from \"../temporary-globals/temporary-globals\";\nimport initExitIntent from \"./init-exit-intent\";\nimport closeModal from \"./modal-actions/close-modal\";\n\nexport default function initModalEventListeners () {\n  // when user goes to exit the page, if politeness rules are met, show modal\n  initExitIntent();\n  // when backdrop clicked, close modal\n  temporaryGlobals.MODAL_ELEM.addEventListener(\"click\", event => onClickModalBackdrop({event}));\n  // when email form submitted, call onSubmit callback and close modal\n  temporaryGlobals.MODAL_FORM_ELEM.addEventListener(\"submit\", event => onSubmit({event}));\n  // when modal close button clicked, close modal\n  temporaryGlobals.MODAL_CLOSE_BUTTON_ELEM.addEventListener('click', () => closeModal());\n  // when Esc key is pressed, close modal\n  document.addEventListener(\"keydown\", (event) => onKeyDown({event}));\n}\n\nfunction onKeyDown ({event}) {\n  if (event.keyCode === 27 && document.body.classList.contains(temporaryGlobals.BODY_CLASS_MODAL_OPEN)) {\n    closeModal();\n  }\n}\n\nfunction onSubmit ({event}) {\n  event.preventDefault();\n\n  // trigger onSubmit callback and pass in the user's email\n  let emailInputElement = event.currentTarget.querySelector(temporaryGlobals.SELECTORS.MODAL_FORM_INPUT_ELEM_SELECTOR);\n  let email = emailInputElement.value;\n  temporaryGlobals.onSubmit({event, email});\n\n  closeModal();\n}\n\nfunction onClickModalBackdrop ({event}) {\n  if (!event.target.closest(temporaryGlobals.SELECTORS.MODAL_FORM_ELEM_SELECTOR)) {\n    closeModal();\n  }\n}\n\n\n\n","export default {\n  WEBSITE_TYPES: {\n    CONTENT: \"CONTENT\",\n    MARKETING: \"MARKETING\"\n  },\n  FOCUSABLE_SELECTORS: 'a[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), *[tabindex]',\n  IS_MOBILE: window.matchMedia(\"only screen and (max-width: 780px)\").matches,\n  MODAL_ELEM_SELECTOR: '.email-modal',\n  MODAL_ELEM_FORM_SELECTOR: '.email-modal__content',\n  MODAL_ELEM_CLOSE_BUTTON_SELECTOR: '.email-modal__close',\n  BODY_CLASS_MODAL_OPEN: 'email-modal-is-open',\n  MODAL_IS_OPENABLE: false,\n  SITE_PAGE_VIEWS: 0,\n  HIGHEST_SCROLL_PERCENTAGE: 0,\n  ACTIVE_TIME_ON_SITE: 0,\n  ACTIVE_TIME_ON_PAGE: 0,\n  // TODO:\n  // MODAL_VIEW_COUNT, \n  // CLOSED_MODAL_DATE, \n  // CLOSED_MODAL_IN_PAST_TWO_WEEKS, \n  // CLOSED_BOTTOM_BAR_DATE,\n  // CLOSED_BOTTOM_BAR_IN_PAST_TWO_WEEKS,\n  setActiveElement (el) {\n    this.activeElement = el;\n  },\n  getActiveElement () {\n    return this.activeElement;\n  },\n  setModalAsOpenable () {\n    this.MODAL_IS_OPENABLE = true;\n    MiniEvents.trigger(\"MODAL_IS_OPENABLE\", true);\n  },\n  isModalOpenable () {\n    return this.MODAL_IS_OPENABLE;\n  }\n}\n\n\n\n\n\n","import initEmailForms from \"./init-email-forms\";\nimport globals from \"./helpers/globals\";\n\nfunction contentWebsite (options) {\n  options.websiteType = globals.WEBSITE_TYPES.CONTENT;\n  initEmailForms(options);\n}\n\nfunction marketingWebsite (options) {\n  options.websiteType = globals.WEBSITE_TYPES.MARKETING;\n  initEmailForms(options);\n}\n\nexport default {\n  contentWebsite,\n  marketingWebsite\n}"],"names":["func","transform","objectProto","Object","prototype","funcToString","Function","toString","hasOwnProperty","objectCtorString","call","objectToString","getPrototype","getPrototypeOf","arg","value","result","e","proto","Ctor","constructor","persistentGlobals","tigerlily","window","minimumsLookup","pageViews","content","notAggressive","aggressive","marketing","activeTimeOnPage","activeTimeOnSite","highestScrollPercentageAcrossAllPages","meetsTriggerRequirements","websiteType","temporaryGlobals","beSlightlyMoreAggressive","console","log","minimums","cache","getElem","selector","document","querySelector","addHtmlToPage","htmlString","body","insertAdjacentHTML","_toConsumableArray","arr","Array","isArray","i","arr2","length","from","hasPassiveEvents","passiveTestOptions","passive","addEventListener","removeEventListener","isIosDevice","navigator","platform","test","maxTouchPoints","locks","documentListenerAdded","initialClientY","previousBodyOverflowSetting","previousBodyPaddingRight","allowTouchMove","el","some","lock","options","preventDefault","rawEvent","event","target","touches","closeModal","classList","remove","BODY_CLASS_MODAL_OPEN","MODAL_ELEM","style","display","querySelectorAll","FOCUSABLE_SELECTORS","forEach","removeAttribute","setAttribute","activeElement","focus","targetElement","error","ontouchstart","ontouchmove","filter","undefined","setTimeout","paddingRight","overflow","enableBodyScroll","initEmailForms","fn","exitIntentCallback","on","prop","path","oldValue","userDefinedGlobals","defaultGlobals","showDebugNotice","onSubmit","imageSrc","headingText","descriptionText","mainButtonText","closeButtonText","SELECTORS","MODAL_ELEM_SELECTOR","MODAL_FORM_ELEM_SELECTOR","MODAL_FORM_INPUT_ELEM_SELECTOR","MODAL_CLOSE_BUTTON_ELEM_SELECTOR","DEBUG_ELEM_RESET_SELECTOR","IS_MOBILE","matchMedia","matches","DEBUG_UNIT_PAGE_VIEWS","DEBUG_UNIT_HIGHEST_SCROLL_PERCENTAGE","DEBUG_UNIT_ACTIVE_TIME_ON_SITE","DEBUG_UNIT_ACTIVE_TIME_ON_PAGE","assign","toLowerCase","Error","initTemporaryGlobals","Number","isNaN","n","t","o","c","arguments","apply","slice","throttle","currentScrollPercentage","docScrollHeight","Math","max","scrollHeight","documentElement","offsetHeight","clientHeight","scrollPercentage","pageYOffset","floor","getScrollPercentage","setHighestScrollPercentage","getModalTemplateString","getBottomBarTemplateString","MODAL_FORM_ELEM","MODAL_CLOSE_BUTTON_ELEM","DEBUG_RESET_ELEM","initElemGlobals","localStorage","clear","location","reload","isModalOpenable","add","focusableElements","focusableElementsInModal","globals","modalElem","focusableElementsInModalArray","includes","children","concat","targetTouches","clientY","scrollTop","isTargetElementTotallyScrolled","stopPropagation","handleScroll","_lock","disableBodyScroll","openModal","mouseNearTopOfPage","mouseDidntEnterAnotherElement","relatedTarget","mouseEventIsNotInsideAnInputElement","nodeName","closest","onClickModalBackdrop","emailInputElement","currentTarget","email","keyCode","contains","onKeyDown","readyState","WEBSITE_TYPES","CONTENT","MARKETING","MODAL_ELEM_FORM_SELECTOR","MODAL_ELEM_CLOSE_BUTTON_SELECTOR","MODAL_IS_OPENABLE","SITE_PAGE_VIEWS","HIGHEST_SCROLL_PERCENTAGE","ACTIVE_TIME_ON_SITE","ACTIVE_TIME_ON_PAGE","setActiveElement","this","getActiveElement","setModalAsOpenable","MiniEvents","trigger","contentWebsite","marketingWebsite"],"mappings":"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"}