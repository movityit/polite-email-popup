var e,t,n=Object.prototype,a=Function.prototype.toString,s=n.hasOwnProperty,i=a.call(Object),o=n.toString,r=(e=Object.getPrototypeOf,t=Object,function(n){return e(t(n))});function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function c(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return l(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?l(e,void 0):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0;return function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function u(){this.callbacksLookup={}}u.prototype={emit:function(e,t){for(var n,a=this.callbacksLookup["*"]||[],s=c(this.callbacksLookup[e]||[]);!(n=s()).done;)(0,n.value)({name:e,value:t});for(var i,o=c(a);!(i=o()).done;)(0,i.value)({name:e,value:t})},on:function(e,t){for(var n,a=c(Array.isArray(e)?e:[e]);!(n=a()).done;){var s=n.value;this.callbacksLookup[s]||(this.callbacksLookup[s]=[]),this.callbacksLookup[s].push(t)}}};var m=new u;function d(e,t){void 0===t&&(t={}),e=e||"tigerlily";var n=t.defaults,l=void 0===n?{}:n,c=JSON.parse(localStorage.getItem(e)||"{}",v);return c=Object.assign(l,c),new Proxy(c,function t(n){return{get:function(e,a){return g(e[a])?new Proxy(e[a],t(n)):e[a]},set:function(t,l,c){t[l]=c,localStorage.setItem(e,JSON.stringify(n,_));var u=t[l],d=g(u)?JSON.parse(JSON.stringify(u,_),v):u,E=g(c)?JSON.parse(JSON.stringify(c,_),v):c,b=function(e,t){if(e===t)return"";var n="";return function e(t,n,l){l=l||"",Array.isArray(t)?function(t,n,a){t.forEach((t,s,i)=>{const o=`${a}[${s}]`;n.call(i,t,s,i,o),e(i[s],n,o)})}(t,n,l):function(e){if(!function(e){return!!e&&"object"==typeof e}(e)||"[object Object]"!=o.call(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e))return!1;var t=r(e);if(null===t)return!0;var n=s.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&a.call(n)==i}(t)&&function(t,n,a){for(const s in t){const i=a?`${a}.${s}`:s;n.call(t,t[s],s,t,i),e(t[s],n,i)}}(t,n,l)}(e,function(e,a,s,i){e===t&&(n=i)}),n}(n,c)||l;return m.emit(b,{prop:l,path:b,oldValue:d,value:E}),!0}}}(c))}function g(e){return Array.isArray(e)||"[object Object]"===Object.prototype.toString.call(e)}function _(e,t){if(this[e]instanceof Date){var n=this[e].getTime();return n?{__isDate:!0,ms:n}:void 0}return t}function v(e,t){return g(t)&&t.__isDate?new Date(t.ms):t}let E;d.on=function(e,t){m.on(e,function(e){t(e.value)})},E||(E=d("polite-email-popup")),window.persistentGlobals=E;var b={};const O={pageViews:{content:{notAggressive:0,aggressive:0},marketing:{notAggressive:3,aggressive:2}},activeTimeOnPage:{content:{notAggressive:8,aggressive:6},marketing:{notAggressive:8,aggressive:6}},activeTimeOnSite:{content:{notAggressive:30,aggressive:20},marketing:{notAggressive:30,aggressive:20}},highestScrollPercentageAcrossAllPages:{content:{notAggressive:35,aggressive:25},marketing:{notAggressive:0,aggressive:0}}},f={pageViews:{content:{notAggressive:0,aggressive:0},marketing:{notAggressive:0,aggressive:0}},activeTimeOnPage:{content:{notAggressive:0,aggressive:0},marketing:{notAggressive:0,aggressive:0}},activeTimeOnSite:{content:{notAggressive:15,aggressive:10},marketing:{notAggressive:15,aggressive:10}},highestScrollPercentageAcrossAllPages:{content:{notAggressive:25,aggressive:20},marketing:{notAggressive:25,aggressive:20}}};let p={};function T(e){return p[e]||document.querySelector(e)}function L(e){return"number"==typeof e&&!Number.isNaN(e)}function S(e){document.body.insertAdjacentHTML("beforeend",e)}function A(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var M=!1;if("undefined"!=typeof window){var h={get passive(){M=!0}};window.addEventListener("testPassive",null,h),window.removeEventListener("testPassive",null,h)}var y="undefined"!=typeof window&&window.navigator&&window.navigator.platform&&(/iP(ad|hone|od)/.test(window.navigator.platform)||"MacIntel"===window.navigator.platform&&window.navigator.maxTouchPoints>1),B=[],w=!1,R=-1,P=void 0,C=void 0,D=function(e){return B.some(function(t){return!(!t.options.allowTouchMove||!t.options.allowTouchMove(e))})},q=function(e){var t=e||window.event;return!!D(t.target)||t.touches.length>1||(t.preventDefault&&t.preventDefault(),!1)};function N(){E.modalClosedDate=Date.now(),document.body.classList.remove(b.BODY_CLASS_MODAL_OPEN),b.MODAL_ELEM.style.display="none",document.querySelectorAll(b.FOCUSABLE_SELECTORS).forEach(e=>e.removeAttribute("tabindex")),document.querySelectorAll("body > [aria-hidden]").forEach(e=>e.removeAttribute("aria-hidden")),b.MODAL_ELEM.setAttribute("aria-hidden","true"),b.activeElement&&b.activeElement.focus(),function(e){if(y){if(!e)return void console.error("enableBodyScroll unsuccessful - targetElement must be provided when calling enableBodyScroll on IOS devices.");e.ontouchstart=null,e.ontouchmove=null,B=B.filter(function(t){return t.targetElement!==e}),w&&0===B.length&&(document.removeEventListener("touchmove",q,M?{passive:!1}:void 0),w=!1)}else(B=B.filter(function(t){return t.targetElement!==e})).length||setTimeout(function(){void 0!==C&&(document.body.style.paddingRight=C,C=void 0),void 0!==P&&(document.body.style.overflow=P,P=void 0)})}(b.MODAL_ELEM)}function k(e){27===e.keyCode&&document.body.classList.contains(b.BODY_CLASS_MODAL_OPEN)&&N()}function U(e){e.preventDefault();let t=e.currentTarget.querySelector(b.SELECTORS.MODAL_FORM_INPUT_ELEM_SELECTOR);b.onSubmit({event:e,email:t.value}),N()}function $(e){e.target.closest(b.SELECTORS.MODAL_FORM_ELEM_SELECTOR)||N()}function x(){b.BOTTOM_BAR_ELEM.classList.remove("show"),document.body.classList.remove(b.BODY_CLASS_BOTTOM_BAR_OPEN)}function V(e){e.preventDefault();let t=e.currentTarget.querySelector(b.SELECTORS.BOTTOM_BAR_FORM_INPUT_ELEM_SELECTOR);b.onSubmit({event:e,email:t.value}),x()}function j(e){var t;t=()=>{var t;!function(e){const t={showDebugNotice:!1,websiteType:"content",beSlightlyMoreAggressive:!1,onSubmit:()=>{console.log("Event: Email form submitted")},imageSrc:"",headingText:"Sign up for updates",descriptionText:"Get cutting edge articles and insights into our process",mainButtonText:"Sign up",closeButtonText:"Close",SELECTORS:{MODAL_ELEM_SELECTOR:".email-modal",MODAL_FORM_ELEM_SELECTOR:".email-modal__content",MODAL_FORM_INPUT_ELEM_SELECTOR:".email-signup-form-input",MODAL_CLOSE_BUTTON_ELEM_SELECTOR:".email-modal__close",BOTTOM_BAR_ELEM_SELECTOR:".bottom-bar",BOTTOM_BAR_FORM_INPUT_ELEM_SELECTOR:".email-signup-form-input",BOTTOM_BAR_FORM_ELEM_SELECTOR:"form.bottom-bar__content",BOTTOM_BAR_CLOSE_BUTTON_ELEM_SELECTOR:".bottom-bar__close",DEBUG_ELEM:".polite-email-popup__debug-notice",DEBUG_ELEM_RESET_SELECTOR:".debug-email-forms__reset",DEBUG_ELEM_BYPASS_SELECTOR:".debug-email-forms__bypass"},IS_MOBILE:window.matchMedia("only screen and (max-width: 780px)").matches,FOCUSABLE_SELECTORS:"a[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), *[tabindex]",BODY_CLASS_MODAL_OPEN:"email-modal-is-open",BODY_CLASS_BOTTOM_BAR_OPEN:"email-bottom-bar-is-open"};Object.assign(b,t,e),window.temporaryGlobals=b}(e),b.showDebugNotice&&S("<div class='polite-email-popup__debug-notice'></div>"),S(function({imageSrc:e,headingText:t,descriptionText:n,mainButtonText:a}){return`\n<div class="email-modal" role="dialog" aria-labelledby="email-modal-title" aria-describedby="email-modal-description" aria-hidden="true">\n  <form class="email-modal__content" method="POST" action="/">\n    <div class="email-modal__top">\n      <div class="email-modal__top-media">\n        <img class="email-modal__top-image" src="${e}">\n      </div>\n      <div class="email-modal__top-content">\n        <h2 class="email-modal__title" id="email-modal-title">${t}</h2>\n        <p class="email-modal__description" id="email-modal-description">${n}</p>\n      </div>\n    </div>\n    <div class="email-modal__input-container">\n      <input class="email-modal__input email-signup-form-input" type="email" value="" placeholder="you@example.com" required>\n    </div>\n    <div class="email-modal__button-container">\n      <button class="email-modal__sign-up" type="submit">${a}</button>\n    </div>\n    <button class="email-modal__close" type="button"></button>\n  </form>\n</div>\n`}(b)),S(function({headingText:e,mainButtonText:t,closeButtonText:n}){return`<div class="bottom-bar" aria-hidden="true">\n  <form class="bottom-bar__content" method="POST" action="/">\n    <label class="bottom-bar__label">\n      <span class="bottom-bar__label-text">${e}</span>\n      <input class="bottom-bar__input email-signup-form-input" type="email" value="" placeholder="you@example.com" required>\n    </label>\n    <button class="bottom-bar__sign-up" type="submit">${t}</button>\n  </form>\n  <div class="bottom-bar__close-container">\n    <button class="bottom-bar__close" type="button">\n      <span class="hide-mobile">${n}</span>\n      <span class="bottom-bar__close-x-icon hide-desktop"><span></span></span>\n    </button>\n  </div>\n</div>`}(b)),function(){let{SELECTORS:e}=b;Object.assign(b,{MODAL_ELEM:T(e.MODAL_ELEM_SELECTOR),MODAL_FORM_ELEM:T(e.MODAL_FORM_ELEM_SELECTOR),MODAL_CLOSE_BUTTON_ELEM:T(e.MODAL_CLOSE_BUTTON_ELEM_SELECTOR),BOTTOM_BAR_ELEM:T(e.BOTTOM_BAR_ELEM_SELECTOR),BOTTOM_BAR_FORM_ELEM:T(e.BOTTOM_BAR_FORM_ELEM_SELECTOR),BOTTOM_BAR_CLOSE_BUTTON_ELEM:T(e.BOTTOM_BAR_CLOSE_BUTTON_ELEM_SELECTOR),DEBUG_NOTICE_ELEM:T(e.DEBUG_ELEM)})}(),d.on("*",function({}){let[e,t,n]=function(){let[e,t]=function(){let e=b.websiteType,t=b.beSlightlyMoreAggressive?"aggressive":"notAggressive";return[{pageViews:O.pageViews[e][t],activeTimeOnPage:O.activeTimeOnPage[e][t],activeTimeOnSite:O.activeTimeOnSite[e][t],highestScrollPercentageAcrossAllPages:O.highestScrollPercentageAcrossAllPages[e][t]},{pageViews:E.pageViews,activeTimeOnPage:E.activeTimeOnPage,activeTimeOnSite:E.activeTimeOnSite,highestScrollPercentageAcrossAllPages:E.highestScrollPercentageAcrossAllPages}]}();return[Object.keys(e).every(n=>t[n]>=e[n]),e,t]}(),[a,s,i]=function(){let[e,t]=function(){let e=b.websiteType,t=b.beSlightlyMoreAggressive?"aggressive":"notAggressive";return[{pageViews:f.pageViews[e][t],activeTimeOnPage:f.activeTimeOnPage[e][t],activeTimeOnSite:f.activeTimeOnSite[e][t],highestScrollPercentageAcrossAllPages:f.highestScrollPercentageAcrossAllPages[e][t]},{pageViews:E.pageViews,activeTimeOnPage:E.activeTimeOnPage,activeTimeOnSite:E.activeTimeOnSite,highestScrollPercentageAcrossAllPages:E.highestScrollPercentageAcrossAllPages}]}();return[Object.keys(e).every(n=>t[n]>=e[n]),e,t]}();e&&(b.isModalOpenable=!0),a&&(b.BOTTOM_BAR_ELEM.classList.add("show"),document.body.classList.add(b.BODY_CLASS_BOTTOM_BAR_OPEN)),b.showDebugNotice&&function({modalRequirements:e,modalActualValues:t,modalMeetsRequirements:n,bottomBarRequirements:a,bottomBarActualValues:s,bottomBarMeetsRequirements:i}){b.DEBUG_NOTICE_ELEM.innerHTML=function({modalRequirements:e,modalActualValues:t,modalMeetsRequirements:n,bottomBarRequirements:a}){let s=function(){let e=E.modalClosedDate;if(e)return{days:Math.floor((Date.now()-e)/864e5)}}();return`<div class="debug-email-forms">\n  <div class="debug-email-forms__stat">\n    <span class="debug-email-forms__stat-label">Website type: </span>\n    <span class="debug-email-forms__stat-value">${b.websiteType.charAt(0).toUpperCase()+b.websiteType.slice(1)} website</span>\n  </div>\n  <div class="debug-email-forms__stat debug-email-forms__stat--buttons">\n    <button class="debug-email-forms__reset" type="button">Reset</button>\n    <button class="debug-email-forms__bypass" type="button">Bypass requirements</button>\n  </div>\n  <div class="debug-email-forms__stat">\n    <span class="debug-email-forms__stat-label">Page views: </span>\n    <span class="debug-email-forms__stat-value">${t.pageViews}</span>\n    <ul class="debug-email-forms__stat-requirements">\n      <li class="debug-email-forms__stat-requirement">Modal requires: ${e.pageViews}</li>\n      <li class="debug-email-forms__stat-requirement">Bottom bar requires: ${a.pageViews}</li>\n    </ul>\n  </div>\n  <div class="debug-email-forms__stat">\n    <span class="debug-email-forms__stat-label">Highest scroll percentage: </span>\n    <span class="debug-email-forms__stat-value">${t.highestScrollPercentageAcrossAllPages}% </span>\n    <ul class="debug-email-forms__stat-requirements">\n      <li class="debug-email-forms__stat-requirement">Modal requires: ${e.highestScrollPercentageAcrossAllPages}%</li>\n      <li class="debug-email-forms__stat-requirement">Bottom bar requires: ${a.highestScrollPercentageAcrossAllPages}%</li>\n    </ul>\n  </div>\n  <div class="debug-email-forms__stat">\n    <span class="debug-email-forms__stat-label">Active time on site: </span>\n    <span class="debug-email-forms__stat-value">${t.activeTimeOnSite}s </span>\n    <ul class="debug-email-forms__stat-requirements">\n      <li class="debug-email-forms__stat-requirement">Modal requires: ${e.activeTimeOnSite}s</li>\n      <li class="debug-email-forms__stat-requirement">Bottom bar requires: ${a.activeTimeOnSite}s</li>\n    </ul>\n  </div>\n  <div class="debug-email-forms__stat">\n    <span class="debug-email-forms__stat-label">Active time on page: </span>\n    <span class="debug-email-forms__stat-value">${t.activeTimeOnPage}s </span>\n    <ul class="debug-email-forms__stat-requirements">\n      <li class="debug-email-forms__stat-requirement">Modal requires: ${e.activeTimeOnPage}s</li>\n      <li class="debug-email-forms__stat-requirement">Bottom bar requires: ${a.activeTimeOnPage}s</li>\n    </ul>\n  </div>\n  <div class="debug-email-forms__stat">\n    <span class="debug-email-forms__stat-label">Modal closed: </span>\n    <span class="debug-email-forms__stat-value">${s?"never":s+" days ago"}</span>\n  </div>\n  <div class="debug-email-forms__stat">\n    <span class="debug-email-forms__stat-label">Bottom bar closed: </span>\n    <span class="debug-email-forms__stat-value">never</span>\n  </div>\n  <div class="debug-email-forms__stat">\n    <span class="debug-email-forms__stat-label">Modal is openable: </span>\n    ${n?'<span class="debug-email-forms__stat-value debug-email-forms__stat-value--success">Yes</span>':'<span class="debug-email-forms__stat-value debug-email-forms__stat-value--fail">No</span>'}\n  </div>\n</div>`}({modalRequirements:e,modalActualValues:t,modalMeetsRequirements:n,bottomBarRequirements:a,bottomBarActualValues:s,bottomBarMeetsRequirements:i})}({modalRequirements:t,modalActualValues:n,modalMeetsRequirements:e,bottomBarRequirements:s,bottomBarActualValues:i,bottomBarMeetsRequirements:a})}),L(E.pageViews)?E.pageViews++:E.pageViews=1,L(E.highestScrollPercentageAcrossAllPages)||(E.highestScrollPercentageAcrossAllPages=0),L(E.activeTimeOnSite)||(E.activeTimeOnSite=0),E.activeTimeOnPage=0,window.addEventListener("scroll",function(e,t){var n=!0,a=!1;return function(){var t=arguments;a||(a=!0,setTimeout(function(){e.apply(void 0,[].slice.call(t)),a=!1},n?0:1e3),n=!1)}}(function(){!function(){let e=function(){let e=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight),t=window.pageYOffset/(e-document.documentElement.clientHeight);return Math.floor(100*t)}();e>E.highestScrollPercentageAcrossAllPages&&(E.highestScrollPercentageAcrossAllPages=e)}(),E.activeTimeOnPage++,E.activeTimeOnSite++})),b.showDebugNotice&&document.addEventListener("click",e=>{e.target.closest(b.SELECTORS.DEBUG_ELEM_RESET_SELECTOR)&&(window.localStorage.clear(),window.location.reload()),e.target.closest(b.SELECTORS.DEBUG_ELEM_BYPASS_SELECTOR)&&(E.pageViews=100,E.activeTimeOnPage=100,E.activeTimeOnSite=100,E.highestScrollPercentageAcrossAllPages=100)}),t=()=>{b.isModalOpenable&&function(){b.activeElement=document.activeElement,b.MODAL_ELEM.classList.add("show"),document.body.classList.add(b.BODY_CLASS_MODAL_OPEN),b.MODAL_ELEM.querySelector(b.FOCUSABLE_SELECTORS).focus();const e=document.querySelectorAll(b.FOCUSABLE_SELECTORS),t=b.MODAL_ELEM.querySelectorAll(b.FOCUSABLE_SELECTORS),n=Array.from(t);e.forEach(e=>{n.includes(e)||e.setAttribute("tabindex","-1")}),b.MODAL_ELEM.removeAttribute("aria-hidden"),Array.from(document.body.children).forEach(e=>{e!==b.MODAL_ELEM&&e.setAttribute("aria-hidden","true")}),function(e,t){if(y){if(!e)return void console.error("disableBodyScroll unsuccessful - targetElement must be provided when calling disableBodyScroll on IOS devices.");if(e&&!B.some(function(t){return t.targetElement===e})){var n={targetElement:e,options:{}};B=[].concat(A(B),[n]),e.ontouchstart=function(e){1===e.targetTouches.length&&(R=e.targetTouches[0].clientY)},e.ontouchmove=function(t){1===t.targetTouches.length&&function(e,t){var n=e.targetTouches[0].clientY-R;!D(e.target)&&(t&&0===t.scrollTop&&n>0||function(e){return!!e&&e.scrollHeight-e.scrollTop<=e.clientHeight}(t)&&n<0?q(e):e.stopPropagation())}(t,e)},w||(document.addEventListener("touchmove",q,M?{passive:!1}:void 0),w=!0)}}else{setTimeout(function(){void 0===C&&(window,document),void 0===P&&(P=document.body.style.overflow,document.body.style.overflow="hidden")});var a={targetElement:e,options:{}};B=[].concat(A(B),[a])}}(b.MODAL_ELEM)}()},document.addEventListener("mouseout",function(e){let n=e.clientY<20,a=null===e.relatedTarget,s="select"!==e.target.nodeName.toLowerCase()&&"input"!==e.target.nodeName.toLowerCase();n&&a&&s&&t&&t()}),b.MODAL_ELEM.addEventListener("click",$),b.MODAL_FORM_ELEM.addEventListener("submit",U),b.MODAL_CLOSE_BUTTON_ELEM.addEventListener("click",N),document.addEventListener("keydown",k),b.BOTTOM_BAR_FORM_ELEM.addEventListener("submit",V),b.BOTTOM_BAR_CLOSE_BUTTON_ELEM.addEventListener("click",x)},"loading"!=document.readyState?t():document.addEventListener("DOMContentLoaded",t)}var F={contentWebsite:function(e){e.websiteType="content",j(e)},marketingWebsite:function(e){e.websiteType="marketing",j(e)}};export default F;
//# sourceMappingURL=polite-email-popup.modern.js.map
