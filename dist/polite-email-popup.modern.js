var e,t,a=Object.prototype,s=Function.prototype.toString,n=a.hasOwnProperty,i=s.call(Object),o=a.toString,l=(e=Object.getPrototypeOf,t=Object,function(a){return e(t(a))});function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,s=new Array(t);a<t;a++)s[a]=e[a];return s}function c(e,t){var a;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=function(e,t){if(e){if("string"==typeof e)return r(e,void 0);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?r(e,void 0):void 0}}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var s=0;return function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(a=e[Symbol.iterator]()).next.bind(a)}function m(){this.callbacksLookup={}}m.prototype={emit:function(e,t){for(var a,s=this.callbacksLookup["*"]||[],n=c(this.callbacksLookup[e]||[]);!(a=n()).done;)(0,a.value)({name:e,value:t});for(var i,o=c(s);!(i=o()).done;)(0,i.value)({name:e,value:t})},on:function(e,t){for(var a,s=c(Array.isArray(e)?e:[e]);!(a=s()).done;){var n=a.value;this.callbacksLookup[n]||(this.callbacksLookup[n]=[]),this.callbacksLookup[n].push(t)}}};var u=new m;function g(e,t){void 0===t&&(t={}),e=e||"tigerlily";var a=t.defaults,r=void 0===a?{}:a,c=JSON.parse(localStorage.getItem(e)||"{}",b);return c=Object.assign(r,c),new Proxy(c,function t(a){return{get:function(e,s){return _(e[s])?new Proxy(e[s],t(a)):e[s]},set:function(t,r,c){t[r]=c,localStorage.setItem(e,JSON.stringify(a,d));var m=t[r],g=_(m)?JSON.parse(JSON.stringify(m,d),b):m,p=_(c)?JSON.parse(JSON.stringify(c,d),b):c,v=function(e,t){if(e===t)return"";var a="";return function e(t,a,r){r=r||"",Array.isArray(t)?function(t,a,s){t.forEach((t,n,i)=>{const o=`${s}[${n}]`;a.call(i,t,n,i,o),e(i[n],a,o)})}(t,a,r):function(e){if(!function(e){return!!e&&"object"==typeof e}(e)||"[object Object]"!=o.call(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e))return!1;var t=l(e);if(null===t)return!0;var a=n.call(t,"constructor")&&t.constructor;return"function"==typeof a&&a instanceof a&&s.call(a)==i}(t)&&function(t,a,s){for(const n in t){const i=s?`${s}.${n}`:n;a.call(t,t[n],n,t,i),e(t[n],a,i)}}(t,a,r)}(e,function(e,s,n,i){e===t&&(a=i)}),a}(a,c)||r;return u.emit(v,{prop:r,path:v,oldValue:g,value:p}),!0}}}(c))}function _(e){return Array.isArray(e)||"[object Object]"===Object.prototype.toString.call(e)}function d(e,t){if(this[e]instanceof Date){var a=this[e].getTime();return a?{__isDate:!0,ms:a}:void 0}return t}function b(e,t){return _(t)&&t.__isDate?new Date(t.ms):t}let p;g.on=function(e,t){u.on(e,function(e){t(e.value)})},p||(p=g("polite-email-popup")),window.persistentGlobals=p;var v={};const E={pageViews:{content:{notAggressive:0,aggressive:0},marketing:{notAggressive:3,aggressive:2}},activeTimeOnPage:{content:{notAggressive:8,aggressive:6},marketing:{notAggressive:8,aggressive:6}},activeTimeOnSite:{content:{notAggressive:30,aggressive:20},marketing:{notAggressive:30,aggressive:20}},highestScrollPercentageAcrossAllPages:{content:{notAggressive:35,aggressive:25},marketing:{notAggressive:0,aggressive:0}}},O={pageViews:{content:{notAggressive:0,aggressive:0},marketing:{notAggressive:0,aggressive:0}},activeTimeOnPage:{content:{notAggressive:0,aggressive:0},marketing:{notAggressive:0,aggressive:0}},activeTimeOnSite:{content:{notAggressive:15,aggressive:10},marketing:{notAggressive:15,aggressive:10}},highestScrollPercentageAcrossAllPages:{content:{notAggressive:25,aggressive:20},marketing:{notAggressive:25,aggressive:20}}};let f={};function T(e){return f[e]||document.querySelector(e)}function A(e){return"number"==typeof e&&!Number.isNaN(e)}function S(e){document.body.insertAdjacentHTML("beforeend",e)}if("undefined"!=typeof window){var L={get passive(){}};window.addEventListener("testPassive",null,L),window.removeEventListener("testPassive",null,L)}function M(e){var t;t=()=>{!function(e){const t={showDebugNotice:!1,websiteType:"content",beSlightlyMoreAggressive:!1,onSubmit:()=>{console.log("Event: Email form submitted")},imageSrc:"",headingText:"Sign up for updates",descriptionText:"Get cutting edge articles and insights into our process",mainButtonText:"Sign up",closeButtonText:"Close",SELECTORS:{MODAL_ELEM_SELECTOR:".email-modal",MODAL_FORM_ELEM_SELECTOR:".email-modal__content",MODAL_FORM_INPUT_ELEM_SELECTOR:".email-signup-form-input",MODAL_CLOSE_BUTTON_ELEM_SELECTOR:".email-modal__close",BOTTOM_BAR_ELEM_SELECTOR:".bottom-bar",BOTTOM_BAR_FORM_ELEM_SELECTOR:"form.bottom-bar__content",BOTTOM_BAR_CLOSE_BUTTON_ELEM_SELECTOR:".bottom-bar__close",DEBUG_ELEM:".polite-email-popup__debug-notice",DEBUG_ELEM_RESET_SELECTOR:".debug-email-forms__reset",DEBUG_ELEM_BYPASS_SELECTOR:".debug-email-forms__bypass"},IS_MOBILE:window.matchMedia("only screen and (max-width: 780px)").matches,FOCUSABLE_SELECTORS:"a[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), *[tabindex]",BODY_CLASS_MODAL_OPEN:"email-modal-is-open",BODY_CLASS_BOTTOM_BAR_OPEN:"email-bottom-bar-is-open"};if(Object.assign(v,t,e),v.websiteType=v.websiteType.toLowerCase(),"content"!==v.websiteType&&"marketing"!==v.websiteType)throw Error("websiteType must be set to either 'content' or 'marketing'");window.temporaryGlobals=v}(e),v.showDebugNotice&&S("<div class='polite-email-popup__debug-notice'></div>"),S(function({imageSrc:e,headingText:t,descriptionText:a,mainButtonText:s}){return`\n<div class="email-modal" role="dialog" aria-labelledby="email-modal-title" aria-describedby="email-modal-description" aria-hidden="true">\n  <form class="email-modal__content" method="POST" action="/">\n    <div class="email-modal__top">\n      <div class="email-modal__top-media">\n        <img class="email-modal__top-image" src="${e}">\n      </div>\n      <div class="email-modal__top-content">\n        <h2 class="email-modal__title" id="email-modal-title">${t}</h2>\n        <p class="email-modal__description" id="email-modal-description">${a}</p>\n      </div>\n    </div>\n    <div class="email-modal__input-container">\n      <input class="email-modal__input email-signup-form-input" type="email" value="" placeholder="you@example.com">\n    </div>\n    <div class="email-modal__button-container">\n      <button class="email-modal__sign-up" type="submit">${s}</button>\n    </div>\n    <button class="email-modal__close" type="button"></button>\n  </form>\n</div>\n`}(v)),S(function({headingText:e,mainButtonText:t,closeButtonText:a}){return`<div class="bottom-bar" aria-hidden="true">\n  <form class="bottom-bar__content" method="POST" action="/">\n    <label class="bottom-bar__label">\n      <span class="bottom-bar__label-text">${e}</span>\n      <input class="bottom-bar__input email-signup-form-input" type="email" value="" placeholder="you@example.com">\n    </label>\n    <button class="bottom-bar__sign-up" type="submit">${t}</button>\n  </form>\n  <div class="bottom-bar__close-container">\n    <button class="bottom-bar__close" type="button">\n      <span class="hide-mobile">${a}</span>\n      <span class="bottom-bar__close-x-icon hide-desktop"><span></span></span>\n    </button>\n  </div>\n</div>`}(v)),function(){let{SELECTORS:e}=v;Object.assign(v,{MODAL_ELEM:T(e.MODAL_ELEM_SELECTOR),MODAL_FORM_ELEM:T(e.MODAL_FORM_ELEM_SELECTOR),MODAL_CLOSE_BUTTON_ELEM:T(e.MODAL_CLOSE_BUTTON_ELEM_SELECTOR),BOTTOM_BAR_ELEM:T(e.BOTTOM_BAR_ELEM_SELECTOR),BOTTOM_BAR_FORM_ELEM:T(e.BOTTOM_BAR_FORM_ELEM_SELECTOR),BOTTOM_BAR_CLOSE_BUTTON_ELEM:T(e.BOTTOM_BAR_CLOSE_BUTTON_ELEM_SELECTOR),DEBUG_NOTICE_ELEM:T(e.DEBUG_ELEM)})}(),g.on("*",function({}){let[e,t,a]=function(){let[e,t]=function(){let e=v.websiteType,t=v.beSlightlyMoreAggressive?"aggressive":"notAggressive";return[{pageViews:E.pageViews[e][t],activeTimeOnPage:E.activeTimeOnPage[e][t],activeTimeOnSite:E.activeTimeOnSite[e][t],highestScrollPercentageAcrossAllPages:E.highestScrollPercentageAcrossAllPages[e][t]},{pageViews:p.pageViews,activeTimeOnPage:p.activeTimeOnPage,activeTimeOnSite:p.activeTimeOnSite,highestScrollPercentageAcrossAllPages:p.highestScrollPercentageAcrossAllPages}]}();return[Object.keys(e).every(a=>t[a]>=e[a]),e,t]}(),[s,n,i]=function(){let[e,t]=function(){let e=v.websiteType,t=v.beSlightlyMoreAggressive?"aggressive":"notAggressive";return[{pageViews:O.pageViews[e][t],activeTimeOnPage:O.activeTimeOnPage[e][t],activeTimeOnSite:O.activeTimeOnSite[e][t],highestScrollPercentageAcrossAllPages:O.highestScrollPercentageAcrossAllPages[e][t]},{pageViews:p.pageViews,activeTimeOnPage:p.activeTimeOnPage,activeTimeOnSite:p.activeTimeOnSite,highestScrollPercentageAcrossAllPages:p.highestScrollPercentageAcrossAllPages}]}();return[Object.keys(e).every(a=>t[a]>=e[a]),e,t]}();e&&(v.isModalOpenable=!0),s&&(v.BOTTOM_BAR_ELEM.classList.add("show"),document.body.classList.add(v.BODY_CLASS_BOTTOM_BAR_OPEN)),v.showDebugNotice&&function({modalRequirements:e,modalActualValues:t,modalMeetsRequirements:a,bottomBarRequirements:s,bottomBarActualValues:n,bottomBarMeetsRequirements:i}){v.DEBUG_NOTICE_ELEM.innerHTML=function({modalRequirements:e,modalActualValues:t,modalMeetsRequirements:a,bottomBarRequirements:s}){return`<div class="debug-email-forms">\n  <div class="debug-email-forms__stat">\n    <span class="debug-email-forms__stat-label">Website type: </span>\n    <span class="debug-email-forms__stat-value">${v.websiteType.charAt(0).toUpperCase()+v.websiteType.slice(1)} website</span>\n  </div>\n  <div class="debug-email-forms__stat debug-email-forms__stat--buttons">\n    <button class="debug-email-forms__reset" type="button">Reset</button>\n    <button class="debug-email-forms__bypass" type="button">Bypass</button>\n  </div>\n  <div class="debug-email-forms__stat">\n    <span class="debug-email-forms__stat-label">Page views: </span>\n    <span class="debug-email-forms__stat-value">${t.pageViews}</span>\n    <ul class="debug-email-forms__stat-requirements">\n      <li class="debug-email-forms__stat-requirement">Modal requires: ${e.pageViews}</li>\n      <li class="debug-email-forms__stat-requirement">Bottom bar requires: ${s.pageViews}</li>\n    </ul>\n  </div>\n  <div class="debug-email-forms__stat">\n    <span class="debug-email-forms__stat-label">Highest scroll percentage: </span>\n    <span class="debug-email-forms__stat-value">${t.highestScrollPercentageAcrossAllPages}% </span>\n    <ul class="debug-email-forms__stat-requirements">\n      <li class="debug-email-forms__stat-requirement">Modal requires: ${e.highestScrollPercentageAcrossAllPages}%</li>\n      <li class="debug-email-forms__stat-requirement">Bottom bar requires: ${s.highestScrollPercentageAcrossAllPages}%</li>\n    </ul>\n  </div>\n  <div class="debug-email-forms__stat">\n    <span class="debug-email-forms__stat-label">Active time on site: </span>\n    <span class="debug-email-forms__stat-value">${t.activeTimeOnSite}s </span>\n    <ul class="debug-email-forms__stat-requirements">\n      <li class="debug-email-forms__stat-requirement">Modal requires: ${e.activeTimeOnSite}s</li>\n      <li class="debug-email-forms__stat-requirement">Bottom bar requires: ${s.activeTimeOnSite}s</li>\n    </ul>\n  </div>\n  <div class="debug-email-forms__stat">\n    <span class="debug-email-forms__stat-label">Active time on page: </span>\n    <span class="debug-email-forms__stat-value">${t.activeTimeOnPage}s </span>\n    <ul class="debug-email-forms__stat-requirements">\n      <li class="debug-email-forms__stat-requirement">Modal requires: ${e.activeTimeOnPage}s</li>\n      <li class="debug-email-forms__stat-requirement">Bottom bar requires: ${s.activeTimeOnPage}s</li>\n    </ul>\n  </div>\n  <div class="debug-email-forms__stat">\n    <span class="debug-email-forms__stat-label">Closed modal: </span>\n    <span class="debug-email-forms__stat-value">never</span>\n  </div>\n  <div class="debug-email-forms__stat">\n    <span class="debug-email-forms__stat-label">Closed bottom bar: </span>\n    <span class="debug-email-forms__stat-value">never</span>\n  </div>\n  <div class="debug-email-forms__stat">\n    <span class="debug-email-forms__stat-label">Modal is openable: </span>\n    ${a?'<span class="debug-email-forms__stat-value debug-email-forms__stat-value--success">Yes</span>':'<span class="debug-email-forms__stat-value debug-email-forms__stat-value--fail">No</span>'}\n  </div>\n</div>`}({modalRequirements:e,modalActualValues:t,modalMeetsRequirements:a,bottomBarRequirements:s,bottomBarActualValues:n,bottomBarMeetsRequirements:i})}({modalRequirements:t,modalActualValues:a,modalMeetsRequirements:e,bottomBarRequirements:n,bottomBarActualValues:i,bottomBarMeetsRequirements:s})}),A(p.pageViews)?p.pageViews++:p.pageViews=1,A(p.highestScrollPercentageAcrossAllPages)||(p.highestScrollPercentageAcrossAllPages=0),A(p.activeTimeOnSite)||(p.activeTimeOnSite=0),p.activeTimeOnPage=0,window.addEventListener("scroll",function(e,t){var a=!0,s=!1;return function(){var t=arguments;s||(s=!0,setTimeout(function(){e.apply(void 0,[].slice.call(t)),s=!1},a?0:1e3),a=!1)}}(function(){!function(){let e=function(){let e=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight),t=window.pageYOffset/(e-document.documentElement.clientHeight);return Math.floor(100*t)}();e>p.highestScrollPercentageAcrossAllPages&&(p.highestScrollPercentageAcrossAllPages=e)}(),p.activeTimeOnPage++,p.activeTimeOnSite++})),initDebugNotice(),initModal()},"loading"!=document.readyState?t():document.addEventListener("DOMContentLoaded",t)}"undefined"!=typeof window&&window.navigator&&window.navigator.platform&&(/iP(ad|hone|od)/.test(window.navigator.platform)||"MacIntel"===window.navigator.platform&&window);var h={WEBSITE_TYPES:{CONTENT:"CONTENT",MARKETING:"MARKETING"},FOCUSABLE_SELECTORS:"a[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), *[tabindex]",IS_MOBILE:window.matchMedia("only screen and (max-width: 780px)").matches,MODAL_ELEM_SELECTOR:".email-modal",MODAL_ELEM_FORM_SELECTOR:".email-modal__content",MODAL_ELEM_CLOSE_BUTTON_SELECTOR:".email-modal__close",BODY_CLASS_MODAL_OPEN:"email-modal-is-open",MODAL_IS_OPENABLE:!1,SITE_PAGE_VIEWS:0,HIGHEST_SCROLL_PERCENTAGE:0,ACTIVE_TIME_ON_SITE:0,ACTIVE_TIME_ON_PAGE:0,setActiveElement(e){this.activeElement=e},getActiveElement(){return this.activeElement},setModalAsOpenable(){this.MODAL_IS_OPENABLE=!0,MiniEvents.trigger("MODAL_IS_OPENABLE",!0)},isModalOpenable(){return this.MODAL_IS_OPENABLE}},y={contentWebsite:function(e){e.websiteType=h.WEBSITE_TYPES.CONTENT,M(e)},marketingWebsite:function(e){e.websiteType=h.WEBSITE_TYPES.MARKETING,M(e)}};export default y;
//# sourceMappingURL=polite-email-popup.modern.js.map
