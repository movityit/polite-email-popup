{"version":3,"file":"polite-email-popup.js","sources":["../node_modules/tigerlily/dist/tigerlily.module.js","../src/persistent-globals/persistent-globals.js","../src/temporary-globals/temporary-globals.js","../src/helpers/helpers.js","../src/trigger-popups/modal-requirements/get-trigger-requirements.js","../src/trigger-popups/bottom-bar-requirements/get-trigger-requirements.js","../src/trigger-popups/watch-trigger-data.js","../src/trigger-popups/modal-requirements/meets-trigger-requirements.js","../src/trigger-popups/bottom-bar-requirements/meets-trigger-requirements.js","../src/bottom-bar/bottom-bar-actions/open-bottom-bar.js","../src/debug-notice/update-debug-notice.js","../src/debug-notice/get-debug-notice-template-string.js","../src/dom/get-elem.js","../src/persistent-globals/init-persistent-globals.js","../src/dom/add-html-to-page.js","../src/helpers/notifications.js","../src/bottom-bar/bottom-bar-actions/close-bottom-bar.js","../node_modules/body-scroll-lock/lib/bodyScrollLock.mjs","../src/modal/modal-actions/close-modal.js","../src/event-handlers/on-submit.js","../src/integrations/mailchimp.js","../src/modal/init-modal-event-listeners.js","../src/init-email-forms.js","../src/dom/dom-ready.js","../src/temporary-globals/init-temporary-globals.js","../src/modal/get-modal-template-string.js","../src/dom/init-elem-globals.js","../src/helpers/on-exit-intent.js","../src/dom/init-dom-elements.js","../src/bottom-bar/get-bottom-bar-template-string.js","../node_modules/stormcloud/dist/stormcloud.module.js","../src/debug-notice/init-debug-notice-event-listeners.js","../src/modal/init-exit-intent.js","../src/modal/modal-actions/open-modal.js","../src/bottom-bar/init-bottom-bar-event-listeners.js","../src/index.js"],"sourcesContent":["var t,r,n=Object.prototype,e=Function.prototype.toString,o=n.hasOwnProperty,a=e.call(Object),i=n.toString,c=(t=Object.getPrototypeOf,r=Object,function(n){return t(r(n))});function u(t,r){(null==r||r>t.length)&&(r=t.length);for(var n=0,e=new Array(r);n<r;n++)e[n]=t[n];return e}function l(t,r){var n;if(\"undefined\"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,r){if(t){if(\"string\"==typeof t)return u(t,void 0);var n=Object.prototype.toString.call(t).slice(8,-1);return\"Object\"===n&&t.constructor&&(n=t.constructor.name),\"Map\"===n||\"Set\"===n?Array.from(t):\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?u(t,void 0):void 0}}(t))||r&&t&&\"number\"==typeof t.length){n&&(t=n);var e=0;return function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}}}throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}return(n=t[Symbol.iterator]()).next.bind(n)}function f(){this.callbacksLookup={}}f.prototype={emit:function(t,r){for(var n,e=this.callbacksLookup[\"*\"]||[],o=l(this.callbacksLookup[t]||[]);!(n=o()).done;)(0,n.value)({name:t,value:r});for(var a,i=l(e);!(a=i()).done;)(0,a.value)({name:t,value:r})},on:function(t,r){for(var n,e=l(Array.isArray(t)?t:[t]);!(n=e()).done;){var o=n.value;this.callbacksLookup[o]||(this.callbacksLookup[o]=[]),this.callbacksLookup[o].push(r)}}};var s=new f;function y(t,r){void 0===r&&(r={}),t=t||\"tigerlily\";var n=r.defaults,u=void 0===n?{}:n,l=JSON.parse(localStorage.getItem(t)||\"{}\",b);return l=Object.assign(u,l),new Proxy(l,function r(n){return{get:function(t,e){return p(t[e])?new Proxy(t[e],r(n)):t[e]},set:function(r,u,l){r[u]=l,localStorage.setItem(t,JSON.stringify(n,v));var f=r[u],y=p(f)?JSON.parse(JSON.stringify(f,v),b):f,g=p(l)?JSON.parse(JSON.stringify(l,v),b):l,d=function(t,r){if(t===r)return\"\";var n=\"\";return function t(r,n,u){u=u||\"\",Array.isArray(r)?function(r,n,e){r.forEach((r,o,a)=>{const i=`${e}[${o}]`;n.call(a,r,o,a,i),t(a[o],n,i)})}(r,n,u):function(t){if(!function(t){return!!t&&\"object\"==typeof t}(t)||\"[object Object]\"!=i.call(t)||function(t){var r=!1;if(null!=t&&\"function\"!=typeof t.toString)try{r=!!(t+\"\")}catch(t){}return r}(t))return!1;var r=c(t);if(null===r)return!0;var n=o.call(r,\"constructor\")&&r.constructor;return\"function\"==typeof n&&n instanceof n&&e.call(n)==a}(r)&&function(r,n,e){for(const o in r){const a=e?`${e}.${o}`:o;n.call(r,r[o],o,r,a),t(r[o],n,a)}}(r,n,u)}(t,function(t,e,o,a){t===r&&(n=a)}),n}(n,l)||u;return s.emit(d,{prop:u,path:d,oldValue:y,value:g}),!0}}}(l))}function p(t){return Array.isArray(t)||\"[object Object]\"===Object.prototype.toString.call(t)}function v(t,r){if(this[t]instanceof Date){var n=this[t].getTime();return n?{__isDate:!0,ms:n}:void 0}return r}function b(t,r){return p(r)&&r.__isDate?new Date(r.ms):r}y.on=function(t,r){s.on(t,function(t){r(t.value)})};export default y;\n//# sourceMappingURL=tigerlily.module.js.map\n","import tigerlily from \"tigerlily\";\n\nlet persistentGlobals;\n\nif (!persistentGlobals) {\n  persistentGlobals = tigerlily('polite-email-popup');\n}\n\nwindow.persistentGlobals = persistentGlobals; // todo remove\n\nexport {tigerlily, persistentGlobals};","export default {};","import {persistentGlobals} from \"../persistent-globals/persistent-globals\";\n\nexport function getDaysSinceModalClosed () {\n  return getDaysSinceClosed(\"modal\");\n}\n\nexport function getDaysSinceBottomBarClosed () {\n  return getDaysSinceClosed(\"bottom-bar\");\n}\n\nfunction getDaysSinceClosed (popupType) {\n  let closedDate = popupType === \"modal\" ? persistentGlobals.modalClosedDate : persistentGlobals.bottomBarClosedDate;\n\n  if (!closedDate) {\n    return;\n  }\n\n  let oneDay = 1000 * 60 * 60 * 24;\n  let days = Math.floor((Date.now() - closedDate) / oneDay);\n\n  return {days};\n}\n","import {persistentGlobals} from \"../../persistent-globals/persistent-globals\";\nimport temporaryGlobals from \"../../temporary-globals/temporary-globals\";\n\nconst minimumsLookup = {\n  \"pageViews\": {\n    \"content\": {\n      \"notAggressive\": 0,\n      \"aggressive\": 0\n    },\n    \"marketing\": {\n      \"notAggressive\": 2,\n      \"aggressive\": 1\n    }\n  },\n  \"activeTimeOnPage\": {\n    \"content\": {\n      \"notAggressive\": 6,\n      \"aggressive\": 4\n    },\n    \"marketing\": {\n      \"notAggressive\": 6,\n      \"aggressive\": 4\n    }\n  },\n  \"activeTimeOnSite\": {\n    \"content\": {\n      \"notAggressive\": 21,\n      \"aggressive\": 14\n    },\n    \"marketing\": {\n      \"notAggressive\": 21,\n      \"aggressive\": 14\n    }\n  },\n  \"highestScrollPercentageAcrossAllPages\": {\n    \"content\": {\n      \"notAggressive\": 35,\n      \"aggressive\": 25\n    },\n    \"marketing\": {\n      \"notAggressive\": 35,\n      \"aggressive\": 25\n    }\n  }\n};\n\nexport default function getTriggerRequirements () {\n  let websiteType = temporaryGlobals.websiteType;\n  let aggressive = temporaryGlobals.beSlightlyMoreAggressive ? \"aggressive\" : \"notAggressive\";\n\n  const minimums = {\n    pageViews: minimumsLookup[\"pageViews\"][websiteType][aggressive],\n    activeTimeOnPage: minimumsLookup[\"activeTimeOnPage\"][websiteType][aggressive],\n    activeTimeOnSite: minimumsLookup[\"activeTimeOnSite\"][websiteType][aggressive],\n    highestScrollPercentageAcrossAllPages: minimumsLookup[\"highestScrollPercentageAcrossAllPages\"][websiteType][aggressive]\n  };\n\n  const actual = {\n    pageViews: persistentGlobals[\"pageViews\"],\n    activeTimeOnPage: persistentGlobals[\"activeTimeOnPage\"],\n    activeTimeOnSite: persistentGlobals[\"activeTimeOnSite\"],\n    highestScrollPercentageAcrossAllPages: persistentGlobals[\"highestScrollPercentageAcrossAllPages\"],\n  }\n\n  return [minimums, actual];\n}\n\n\n\n","import {persistentGlobals} from \"../../persistent-globals/persistent-globals\";\nimport temporaryGlobals from \"../../temporary-globals/temporary-globals\";\n\nconst minimumsLookup = {\n  \"pageViews\": {\n    \"content\": {\n      \"notAggressive\": 0,\n      \"aggressive\": 0\n    },\n    \"marketing\": {\n      \"notAggressive\": 0,\n      \"aggressive\": 0\n    }\n  },\n  \"activeTimeOnPage\": {\n    \"content\": {\n      \"notAggressive\": 0,\n      \"aggressive\": 0\n    },\n    \"marketing\": {\n      \"notAggressive\": 0,\n      \"aggressive\": 0\n    }\n  },\n  \"activeTimeOnSite\": {\n    \"content\": {\n      \"notAggressive\": 10,\n      \"aggressive\": 7\n    },\n    \"marketing\": {\n      \"notAggressive\": 10,\n      \"aggressive\": 7\n    }\n  },\n  \"highestScrollPercentageAcrossAllPages\": {\n    \"content\": {\n      \"notAggressive\": 25,\n      \"aggressive\": 20\n    },\n    \"marketing\": {\n      \"notAggressive\": 25,\n      \"aggressive\": 20\n    }\n  }\n};\n\nexport default function getTriggerRequirements () {\n  let websiteType = temporaryGlobals.websiteType;\n  let aggressive = temporaryGlobals.beSlightlyMoreAggressive ? \"aggressive\" : \"notAggressive\";\n\n  const minimums = {\n    pageViews: minimumsLookup[\"pageViews\"][websiteType][aggressive],\n    activeTimeOnPage: minimumsLookup[\"activeTimeOnPage\"][websiteType][aggressive],\n    activeTimeOnSite: minimumsLookup[\"activeTimeOnSite\"][websiteType][aggressive],\n    highestScrollPercentageAcrossAllPages: minimumsLookup[\"highestScrollPercentageAcrossAllPages\"][websiteType][aggressive]\n  };\n\n  const actual = {\n    pageViews: persistentGlobals[\"pageViews\"],\n    activeTimeOnPage: persistentGlobals[\"activeTimeOnPage\"],\n    activeTimeOnSite: persistentGlobals[\"activeTimeOnSite\"],\n    highestScrollPercentageAcrossAllPages: persistentGlobals[\"highestScrollPercentageAcrossAllPages\"],\n  }\n\n  return [minimums, actual];\n}\n\n\n\n","import {tigerlily} from \"../persistent-globals/persistent-globals\";\nimport temporaryGlobals from \"../temporary-globals/temporary-globals\";\nimport updateDebugNotice from \"../debug-notice/update-debug-notice\";\nimport modalMeetsTriggerRequirements from \"./modal-requirements/meets-trigger-requirements\";\nimport bottomBarMeetsTriggerRequirements from \"./bottom-bar-requirements/meets-trigger-requirements\";\nimport openBottomBar from \"../bottom-bar/bottom-bar-actions/open-bottom-bar\";\n\nexport function watchTriggerData () {\n  tigerlily.on(\"*\", whenTriggerDataChanges);\n}\n\nexport function whenTriggerDataChanges () {\n\n  // TRIGGER REQUIREMENTS\n  let [modalMeetsRequirements, modalRequirements, modalActualValues] = modalMeetsTriggerRequirements();\n  let [bottomBarMeetsRequirements, bottomBarRequirements, bottomBarActualValues] = bottomBarMeetsTriggerRequirements();\n\n  if (modalMeetsRequirements) {\n    temporaryGlobals.isModalOpenable = true;\n  } else {\n    temporaryGlobals.isModalOpenable = false;\n  }\n\n  if (bottomBarMeetsRequirements) {\n    openBottomBar();\n  }\n\n  if (temporaryGlobals.showDebugNotice) {\n    updateDebugNotice({modalRequirements, modalActualValues, modalMeetsRequirements, bottomBarRequirements, bottomBarActualValues, bottomBarMeetsRequirements});\n  }\n\n}","import getTriggerRequirements from \"./get-trigger-requirements\";\nimport {getDaysSinceModalClosed} from \"../../helpers/helpers\";\nimport temporaryGlobals from \"../../temporary-globals/temporary-globals\";\n\nexport default function meetsTriggerRequirements () {\n  let [requirements, actual] = getTriggerRequirements();\n\n  // compare all the requirements to the actual values\n  let meetsRequirements = Object.keys(requirements).every(key => {\n    return actual[key] >= requirements[key];\n  });\n\n  // must wait a few days before opening the modal again\n  let daysSinceModalClosed = getDaysSinceModalClosed();\n  if (daysSinceModalClosed) {\n    meetsRequirements = meetsRequirements && daysSinceModalClosed.days >= 2;\n  }\n\n  // can't open the modal twice\n  if (temporaryGlobals.isModalOpen) {\n    meetsRequirements = false;\n  }\n\n  return [meetsRequirements, requirements, actual];\n}\n\n\n\n","import getTriggerRequirements from \"./get-trigger-requirements\";\nimport {getDaysSinceBottomBarClosed} from \"../../helpers/helpers\";\n\nexport default function meetsTriggerRequirements () {\n  let [requirements, actual] = getTriggerRequirements();\n\n  let meetsRequirements = Object.keys(requirements).every(key => {\n    return actual[key] >= requirements[key];\n  });\n\n  let daysSinceBottomBarClosed = getDaysSinceBottomBarClosed();\n  if (daysSinceBottomBarClosed) {\n    meetsRequirements = meetsRequirements && daysSinceBottomBarClosed.days >= 2;\n  }\n\n  return [meetsRequirements, requirements, actual];\n}\n\n\n\n","import temporaryGlobals from \"../../temporary-globals/temporary-globals\";\n\nexport default function openBottomBar () {\n  temporaryGlobals.BOTTOM_BAR_ELEM.classList.add(\"show\");\n  document.body.classList.add(temporaryGlobals.BODY_CLASS_BOTTOM_BAR_OPEN);\n}","import temporaryGlobals from \"../temporary-globals/temporary-globals\";\nimport getDebugNoticeTemplateString from \"./get-debug-notice-template-string\";\n\nexport default function updateDebugNotice ({modalRequirements, modalActualValues, modalMeetsRequirements, bottomBarRequirements, bottomBarActualValues, bottomBarMeetsRequirements}) {\n  temporaryGlobals.DEBUG_NOTICE_ELEM.innerHTML = getDebugNoticeTemplateString({modalRequirements, modalActualValues, modalMeetsRequirements, bottomBarRequirements, bottomBarActualValues, bottomBarMeetsRequirements});\n}","import temporaryGlobals from \"../temporary-globals/temporary-globals\";\nimport {getDaysSinceModalClosed, getDaysSinceBottomBarClosed} from \"../helpers/helpers\";\n\nexport default function getDebugNoticeTemplateString ({modalRequirements, modalActualValues, modalMeetsRequirements, bottomBarRequirements, bottomBarActualValues, bottomBarMeetsRequirements}) {\n  let daysSinceModalClosed = getDaysSinceModalClosed();\n  let daysSinceBottomBarClosed = getDaysSinceBottomBarClosed();\n\n  return `<div class=\"debug-email-forms\">\n  <div class=\"debug-email-forms__stat\">\n    <span class=\"debug-email-forms__stat-label\">Website type: </span>\n    <span class=\"debug-email-forms__stat-value\">${temporaryGlobals.websiteType.charAt(0).toUpperCase() + temporaryGlobals.websiteType.slice(1)} website</span>\n  </div>\n  <div class=\"debug-email-forms__stat debug-email-forms__stat--buttons\">\n    <button class=\"debug-email-forms__reset\" type=\"button\">Reset data</button>\n    <button class=\"debug-email-forms__bypass\" type=\"button\">Bypass requirements</button>\n  </div>\n  <div class=\"debug-email-forms__stat\">\n    <span class=\"debug-email-forms__stat-label\">Page views: </span>\n    <span class=\"debug-email-forms__stat-value\">${modalActualValues.pageViews}</span>\n    <ul class=\"debug-email-forms__stat-requirements\">\n      <li class=\"debug-email-forms__stat-requirement\">Modal requires: ${modalRequirements.pageViews}</li>\n      <li class=\"debug-email-forms__stat-requirement\">Bottom bar requires: ${bottomBarRequirements.pageViews}</li>\n    </ul>\n  </div>\n  <div class=\"debug-email-forms__stat\">\n    <span class=\"debug-email-forms__stat-label\">Highest scroll percentage: </span>\n    <span class=\"debug-email-forms__stat-value\">${modalActualValues.highestScrollPercentageAcrossAllPages}% </span>\n    <ul class=\"debug-email-forms__stat-requirements\">\n      <li class=\"debug-email-forms__stat-requirement\">Modal requires: ${modalRequirements.highestScrollPercentageAcrossAllPages}%</li>\n      <li class=\"debug-email-forms__stat-requirement\">Bottom bar requires: ${bottomBarRequirements.highestScrollPercentageAcrossAllPages}%</li>\n    </ul>\n  </div>\n  <div class=\"debug-email-forms__stat\">\n    <span class=\"debug-email-forms__stat-label\">Active time on site: </span>\n    <span class=\"debug-email-forms__stat-value\">${modalActualValues.activeTimeOnSite}s </span>\n    <ul class=\"debug-email-forms__stat-requirements\">\n      <li class=\"debug-email-forms__stat-requirement\">Modal requires: ${modalRequirements.activeTimeOnSite}s</li>\n      <li class=\"debug-email-forms__stat-requirement\">Bottom bar requires: ${bottomBarRequirements.activeTimeOnSite}s</li>\n    </ul>\n  </div>\n  <div class=\"debug-email-forms__stat\">\n    <span class=\"debug-email-forms__stat-label\">Active time on page: </span>\n    <span class=\"debug-email-forms__stat-value\">${modalActualValues.activeTimeOnPage}s </span>\n    <ul class=\"debug-email-forms__stat-requirements\">\n      <li class=\"debug-email-forms__stat-requirement\">Modal requires: ${modalRequirements.activeTimeOnPage}s</li>\n      <li class=\"debug-email-forms__stat-requirement\">Bottom bar requires: ${bottomBarRequirements.activeTimeOnPage}s</li>\n    </ul>\n  </div>\n  <div class=\"debug-email-forms__stat\">\n    <span class=\"debug-email-forms__stat-label\">Modal was closed: </span>\n    <span class=\"debug-email-forms__stat-value\">${daysSinceModalClosed ? (daysSinceModalClosed.days + ` day${daysSinceModalClosed.days !== 1 ? \"s\" : \"\"} ago`) : \"never\"}</span>\n    <ul class=\"debug-email-forms__stat-requirements\">\n      <li class=\"debug-email-forms__stat-requirement\">Requires: never or 2 days ago</li>\n    </ul>\n  </div>\n  <div class=\"debug-email-forms__stat\">\n    <span class=\"debug-email-forms__stat-label\">Bottom bar was closed: </span>\n    <span class=\"debug-email-forms__stat-value\">${daysSinceBottomBarClosed ? (daysSinceBottomBarClosed.days + ` day${daysSinceBottomBarClosed.days !== 1 ? \"s\" : \"\"} ago`) : \"never\"}</span>\n    <ul class=\"debug-email-forms__stat-requirements\">\n      <li class=\"debug-email-forms__stat-requirement\">Requires: never or 2 days ago</li>\n    </ul>\n  </div>\n  <div class=\"debug-email-forms__stat\">\n    <span class=\"debug-email-forms__stat-label\">Modal is openable: </span>\n    ${modalMeetsRequirements ? '<span class=\"debug-email-forms__stat-value debug-email-forms__stat-value--success\">Yes</span>' : '<span class=\"debug-email-forms__stat-value debug-email-forms__stat-value--fail\">No</span>'}\n  </div>\n  <div class=\"debug-email-forms__stat\">\n    <span class=\"debug-email-forms__stat-label\">Bottom bar is open: </span>\n    ${bottomBarMeetsRequirements ? '<span class=\"debug-email-forms__stat-value debug-email-forms__stat-value--success\">Yes</span>' : '<span class=\"debug-email-forms__stat-value debug-email-forms__stat-value--fail\">No</span>'}\n  </div>\n</div>`;\n}","let cache = {};\n// caches result of getting an element\nexport default function getElem (selector) {\n  return cache[selector] || document.querySelector(selector);\n}","import {throttle} from \"stormcloud\";\nimport {persistentGlobals} from \"./persistent-globals\";\n\n/*\n\n  Keep track of:\n  - pageViews\n  - activeTimeOnPage\n  - activeTimeOnSite\n  - highestScrollPercentageAcrossAllPages\n\n*/ \nexport default function initPersistentGlobals (allOptions) {\n  if (!isNumberDefined(persistentGlobals.pageViews)) {\n    persistentGlobals.pageViews = 1;\n  } else {\n    persistentGlobals.pageViews++;\n  }\n\n  if (!isNumberDefined(persistentGlobals.highestScrollPercentageAcrossAllPages)) {\n    persistentGlobals.highestScrollPercentageAcrossAllPages = 0;\n  }\n\n  if (!isNumberDefined(persistentGlobals.activeTimeOnSite)) {\n    persistentGlobals.activeTimeOnSite = 0;\n  }\n\n  // refresh this value for every page\n  persistentGlobals.activeTimeOnPage = 0;\n\n  watchCurrentScrollPercentage();\n}\n\nfunction isNumberDefined (val) {\n  return typeof val === \"number\" && !Number.isNaN(val);\n}\n\nfunction watchCurrentScrollPercentage () {\n  window.addEventListener('scroll', throttle(function () {\n    // will execute once for every second the user is scrolling\n    setHighestScrollPercentage();\n    persistentGlobals.activeTimeOnPage++;\n    persistentGlobals.activeTimeOnSite++;\n  }, 1000));\n}\n\nfunction setHighestScrollPercentage () {\n  let currentScrollPercentage = getScrollPercentage();\n  if (currentScrollPercentage > persistentGlobals.highestScrollPercentageAcrossAllPages) {\n    persistentGlobals.highestScrollPercentageAcrossAllPages = currentScrollPercentage;\n  }\n}\n\nfunction getScrollPercentage () {\n  // get the scroll height of the document (https://javascript.info/size-and-scroll-window#width-height-of-the-document) \n  let docScrollHeight = Math.max(document.body.scrollHeight, document.documentElement.scrollHeight, document.body.offsetHeight, document.documentElement.offsetHeight, document.body.clientHeight, document.documentElement.clientHeight);\n  // calculate scroll percentage (subtract browser height since that's not actually scrollable)\n  let scrollPercentage = window.pageYOffset / (docScrollHeight - document.documentElement.clientHeight);\n  // calculate percentage\n  return Math.floor(scrollPercentage * 100);\n}\n\n\n\n","export default function addHtmlToPage (htmlString) {\n  document.body.insertAdjacentHTML(\"beforeend\", htmlString);\n}","import { Notyf } from 'notyf';\nlet notyf = new Notyf({\n  duration: 5000,\n  position: {\n    x: \"center\",\n    y: \"top\"\n  },\n  dismissible: true\n});\n\nexport function showSuccessMessage (msg) {\n  notyf.success(msg);\n}\n\nexport function showErrorMessage (msg) {\n  notyf.error(msg)\n}\n","import temporaryGlobals from \"../../temporary-globals/temporary-globals\";\nimport {persistentGlobals} from \"../../persistent-globals/persistent-globals\";\n\nexport default function closeBottomBar () {\n  // store date it was clsoed\n  persistentGlobals.bottomBarClosedDate = Date.now();\n\n  temporaryGlobals.BOTTOM_BAR_ELEM.classList.remove(\"show\");\n  document.body.classList.remove(temporaryGlobals.BODY_CLASS_BOTTOM_BAR_OPEN);\n}","function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\n// Older browsers don't support event options, feature detect it.\n\n// Adopted and modified solution from Bohdan Didukh (2017)\n// https://stackoverflow.com/questions/41594997/ios-10-safari-prevent-scrolling-behind-a-fixed-overlay-and-maintain-scroll-posi\n\nvar hasPassiveEvents = false;\nif (typeof window !== 'undefined') {\n  var passiveTestOptions = {\n    get passive() {\n      hasPassiveEvents = true;\n      return undefined;\n    }\n  };\n  window.addEventListener('testPassive', null, passiveTestOptions);\n  window.removeEventListener('testPassive', null, passiveTestOptions);\n}\n\nvar isIosDevice = typeof window !== 'undefined' && window.navigator && window.navigator.platform && (/iP(ad|hone|od)/.test(window.navigator.platform) || window.navigator.platform === 'MacIntel' && window.navigator.maxTouchPoints > 1);\n\n\nvar locks = [];\nvar documentListenerAdded = false;\nvar initialClientY = -1;\nvar previousBodyOverflowSetting = void 0;\nvar previousBodyPaddingRight = void 0;\n\n// returns true if `el` should be allowed to receive touchmove events.\nvar allowTouchMove = function allowTouchMove(el) {\n  return locks.some(function (lock) {\n    if (lock.options.allowTouchMove && lock.options.allowTouchMove(el)) {\n      return true;\n    }\n\n    return false;\n  });\n};\n\nvar preventDefault = function preventDefault(rawEvent) {\n  var e = rawEvent || window.event;\n\n  // For the case whereby consumers adds a touchmove event listener to document.\n  // Recall that we do document.addEventListener('touchmove', preventDefault, { passive: false })\n  // in disableBodyScroll - so if we provide this opportunity to allowTouchMove, then\n  // the touchmove event on document will break.\n  if (allowTouchMove(e.target)) {\n    return true;\n  }\n\n  // Do not prevent if the event has more than one touch (usually meaning this is a multi touch gesture like pinch to zoom).\n  if (e.touches.length > 1) return true;\n\n  if (e.preventDefault) e.preventDefault();\n\n  return false;\n};\n\nvar setOverflowHidden = function setOverflowHidden(options) {\n  // Setting overflow on body/documentElement synchronously in Desktop Safari slows down\n  // the responsiveness for some reason. Setting within a setTimeout fixes this.\n  setTimeout(function () {\n    // If previousBodyPaddingRight is already set, don't set it again.\n    if (previousBodyPaddingRight === undefined) {\n      var _reserveScrollBarGap = !!options && options.reserveScrollBarGap === true;\n      var scrollBarGap = window.innerWidth - document.documentElement.clientWidth;\n\n      if (_reserveScrollBarGap && scrollBarGap > 0) {\n        previousBodyPaddingRight = document.body.style.paddingRight;\n        document.body.style.paddingRight = scrollBarGap + 'px';\n      }\n    }\n\n    // If previousBodyOverflowSetting is already set, don't set it again.\n    if (previousBodyOverflowSetting === undefined) {\n      previousBodyOverflowSetting = document.body.style.overflow;\n      document.body.style.overflow = 'hidden';\n    }\n  });\n};\n\nvar restoreOverflowSetting = function restoreOverflowSetting() {\n  // Setting overflow on body/documentElement synchronously in Desktop Safari slows down\n  // the responsiveness for some reason. Setting within a setTimeout fixes this.\n  setTimeout(function () {\n    if (previousBodyPaddingRight !== undefined) {\n      document.body.style.paddingRight = previousBodyPaddingRight;\n\n      // Restore previousBodyPaddingRight to undefined so setOverflowHidden knows it\n      // can be set again.\n      previousBodyPaddingRight = undefined;\n    }\n\n    if (previousBodyOverflowSetting !== undefined) {\n      document.body.style.overflow = previousBodyOverflowSetting;\n\n      // Restore previousBodyOverflowSetting to undefined\n      // so setOverflowHidden knows it can be set again.\n      previousBodyOverflowSetting = undefined;\n    }\n  });\n};\n\n// https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollHeight#Problems_and_solutions\nvar isTargetElementTotallyScrolled = function isTargetElementTotallyScrolled(targetElement) {\n  return targetElement ? targetElement.scrollHeight - targetElement.scrollTop <= targetElement.clientHeight : false;\n};\n\nvar handleScroll = function handleScroll(event, targetElement) {\n  var clientY = event.targetTouches[0].clientY - initialClientY;\n\n  if (allowTouchMove(event.target)) {\n    return false;\n  }\n\n  if (targetElement && targetElement.scrollTop === 0 && clientY > 0) {\n    // element is at the top of its scroll.\n    return preventDefault(event);\n  }\n\n  if (isTargetElementTotallyScrolled(targetElement) && clientY < 0) {\n    // element is at the bottom of its scroll.\n    return preventDefault(event);\n  }\n\n  event.stopPropagation();\n  return true;\n};\n\nexport var disableBodyScroll = function disableBodyScroll(targetElement, options) {\n  if (isIosDevice) {\n    // targetElement must be provided, and disableBodyScroll must not have been\n    // called on this targetElement before.\n    if (!targetElement) {\n      // eslint-disable-next-line no-console\n      console.error('disableBodyScroll unsuccessful - targetElement must be provided when calling disableBodyScroll on IOS devices.');\n      return;\n    }\n\n    if (targetElement && !locks.some(function (lock) {\n      return lock.targetElement === targetElement;\n    })) {\n      var lock = {\n        targetElement: targetElement,\n        options: options || {}\n      };\n\n      locks = [].concat(_toConsumableArray(locks), [lock]);\n\n      targetElement.ontouchstart = function (event) {\n        if (event.targetTouches.length === 1) {\n          // detect single touch.\n          initialClientY = event.targetTouches[0].clientY;\n        }\n      };\n      targetElement.ontouchmove = function (event) {\n        if (event.targetTouches.length === 1) {\n          // detect single touch.\n          handleScroll(event, targetElement);\n        }\n      };\n\n      if (!documentListenerAdded) {\n        document.addEventListener('touchmove', preventDefault, hasPassiveEvents ? { passive: false } : undefined);\n        documentListenerAdded = true;\n      }\n    }\n  } else {\n    setOverflowHidden(options);\n    var _lock = {\n      targetElement: targetElement,\n      options: options || {}\n    };\n\n    locks = [].concat(_toConsumableArray(locks), [_lock]);\n  }\n};\n\nexport var clearAllBodyScrollLocks = function clearAllBodyScrollLocks() {\n  if (isIosDevice) {\n    // Clear all locks ontouchstart/ontouchmove handlers, and the references.\n    locks.forEach(function (lock) {\n      lock.targetElement.ontouchstart = null;\n      lock.targetElement.ontouchmove = null;\n    });\n\n    if (documentListenerAdded) {\n      document.removeEventListener('touchmove', preventDefault, hasPassiveEvents ? { passive: false } : undefined);\n      documentListenerAdded = false;\n    }\n\n    locks = [];\n\n    // Reset initial clientY.\n    initialClientY = -1;\n  } else {\n    restoreOverflowSetting();\n    locks = [];\n  }\n};\n\nexport var enableBodyScroll = function enableBodyScroll(targetElement) {\n  if (isIosDevice) {\n    if (!targetElement) {\n      // eslint-disable-next-line no-console\n      console.error('enableBodyScroll unsuccessful - targetElement must be provided when calling enableBodyScroll on IOS devices.');\n      return;\n    }\n\n    targetElement.ontouchstart = null;\n    targetElement.ontouchmove = null;\n\n    locks = locks.filter(function (lock) {\n      return lock.targetElement !== targetElement;\n    });\n\n    if (documentListenerAdded && locks.length === 0) {\n      document.removeEventListener('touchmove', preventDefault, hasPassiveEvents ? { passive: false } : undefined);\n\n      documentListenerAdded = false;\n    }\n  } else {\n    locks = locks.filter(function (lock) {\n      return lock.targetElement !== targetElement;\n    });\n    if (!locks.length) {\n      restoreOverflowSetting();\n    }\n  }\n};\n\n","import { enableBodyScroll } from 'body-scroll-lock';\nimport temporaryGlobals from \"../../temporary-globals/temporary-globals\";\nimport {persistentGlobals} from \"../../persistent-globals/persistent-globals\";\nimport {whenTriggerDataChanges} from \"../../trigger-popups/watch-trigger-data\";\n\nexport default function closeModal() {\n  // store date it was clsoed\n  persistentGlobals.modalClosedDate = Date.now();\n\n  // hide the modal\n  temporaryGlobals.MODAL_ELEM.classList.remove(\"show\");\n  // remove body class\n  document.body.classList.remove(temporaryGlobals.BODY_CLASS_MODAL_OPEN);\n\n  // Untrap the tab focus by removing tabindex=-1. You should restore previous values if an element had them.    \n  const focusableElements = document.querySelectorAll(temporaryGlobals.FOCUSABLE_SELECTORS);\n  focusableElements.forEach(el => el.removeAttribute('tabindex'));\n  \n  // Untrap screen reader focus\n  const topLevelElements = document.querySelectorAll(\"body > [aria-hidden]\");\n  topLevelElements.forEach(el => el.removeAttribute('aria-hidden'));\n  temporaryGlobals.MODAL_ELEM.setAttribute('aria-hidden', 'true');\n  \n  // restore focus to the triggering element\n  if (temporaryGlobals.activeElement) {\n    temporaryGlobals.activeElement.focus();\n  }\n\n  enableBodyScroll(temporaryGlobals.MODAL_ELEM);\n\n  temporaryGlobals.isModalOpen = false;\n  // manually recompute `isModalOpenable` because temporary globals don't trigger this automatically\n  whenTriggerDataChanges();\n}","import temporaryGlobals from \"../temporary-globals/temporary-globals\";\nimport {sendEmailToMailChimp} from \"../integrations/mailchimp\";\nimport closeBottomBar from \"../bottom-bar/bottom-bar-actions/close-bottom-bar\";\nimport closeModal from \"../modal/modal-actions/close-modal\";\nimport {showSuccessMessage, showErrorMessage} from \"../helpers/notifications\";\n\nexport function onSubmit (event) {\n  event.preventDefault();\n\n  if (event.currentTarget.closest(\".bottom-bar\")) {\n    closeBottomBar();\n  } else if (event.currentTarget.closest(\".email-modal\")) {\n    closeModal();\n  }\n\n  // SPAM PREVENTION\n  if (event.currentTarget.querySelector('.js-validate-not-robot').value !== '') {\n    return;\n  }\n\n  let emailInputElement = event.currentTarget.querySelector(temporaryGlobals.SELECTORS.BOTTOM_BAR_FORM_INPUT_ELEM_SELECTOR);\n  let email = emailInputElement.value;\n\n  // MAILCHIMP integration\n  let {spamPreventionKey, formAction} = temporaryGlobals.mailchimpConfig;\n  if (spamPreventionKey && formAction) {\n    sendEmailToMailChimp({event, email, spamPreventionKey, formAction});\n  } else {\n    if (temporaryGlobals.showFormSubmissionNotices) {\n      showSuccessMessage();\n    }\n    temporaryGlobals.onSubmit({event, email});\n  }\n}","import temporaryGlobals from \"../temporary-globals/temporary-globals\";\nimport {showSuccessMessage, showErrorMessage} from \"../helpers/notifications\";\n\nexport function sendEmailToMailChimp ({event, email, spamPreventionKey, formAction, userDefinedCallback}) {\n  // Get url for mailchimp\n  let url = (formAction || \"\").replace('/post?', '/post-json?');\n\n  // Add form data to object\n  let data = '';\n  let inputs = event.currentTarget.querySelectorAll('input');\n  for (let i = 0; i < inputs.length; i++) {\n    data += '&' + inputs[i].name + '=' + encodeURIComponent(inputs[i].value);\n  }\n\n  // Add Mailchimps spam prevention key to data\n  data += '&' + spamPreventionKey + '=' + \"\";\n\n  // Create & add post script to the DOM\n  let script = document.createElement('script');\n  script.src = url + data + \"&c=mailchimpCallback\";\n  document.body.appendChild(script);\n\n  // Callback function\n  let callback = 'mailchimpCallback';\n  window[callback] = function(res) {\n\n    // Remove post script from the DOM\n    delete window[callback];\n    document.body.removeChild(script);\n\n    // Display notices\n    if (temporaryGlobals.showFormSubmissionNotices) {\n      if (res.result === \"success\") {\n        showSuccessMessage(temporaryGlobals.successMessage);\n      } else {\n        showErrorMessage(temporaryGlobals.failureMessage);\n      } \n    }\n\n    // Call user defined onSubmit callback\n    if (res.result === \"success\") {\n      temporaryGlobals.onSubmit({event, email, success: true});\n    } else {\n      temporaryGlobals.onSubmit({event, email, success: false});\n    }\n\n  };\n}\n","import temporaryGlobals from \"../temporary-globals/temporary-globals\";\nimport {onSubmit} from \"../event-handlers/on-submit\";\nimport initExitIntent from \"./init-exit-intent\";\nimport closeModal from \"./modal-actions/close-modal\";\n\nexport default function initModalEventListeners () {\n  // when user goes to exit the page, if politeness rules are met, show modal\n  initExitIntent();\n  // when backdrop clicked, close modal\n  temporaryGlobals.MODAL_ELEM.addEventListener(\"click\", onClickModalBackdrop);\n  // when email form submitted, call onSubmit callback and close modal\n  temporaryGlobals.MODAL_FORM_ELEM.addEventListener(\"submit\", onSubmit);\n  // when modal close button clicked, close modal\n  temporaryGlobals.MODAL_CLOSE_BUTTON_ELEM.addEventListener('click', closeModal);\n  // when Esc key is pressed, close modal\n  document.addEventListener(\"keydown\", onKeyDown);\n}\n\nfunction onKeyDown (event) {\n  if (event.keyCode === 27 && document.body.classList.contains(temporaryGlobals.BODY_CLASS_MODAL_OPEN)) {\n    closeModal();\n  }\n}\n\nfunction onClickModalBackdrop (event) {\n  if (!event.target.closest(temporaryGlobals.SELECTORS.MODAL_FORM_ELEM_SELECTOR)) {\n    closeModal();\n  }\n}\n\n\n\n","import domReady from \"./dom/dom-ready\";\n\nimport {watchTriggerData} from \"./trigger-popups/watch-trigger-data\";\nimport initTemporaryGlobals from \"./temporary-globals/init-temporary-globals\";\nimport initPersistentGlobals from \"./persistent-globals/init-persistent-globals\";\nimport initDomElements from \"./dom/init-dom-elements\";\n\nimport initDebugNoticeEventListeners from \"./debug-notice/init-debug-notice-event-listeners\";\nimport initModalEventListeners from \"./modal/init-modal-event-listeners\";\nimport initBottomBarEventListeners from \"./bottom-bar/init-bottom-bar-event-listeners\";\n\nexport default function initEmailForms (options) {\n  domReady(() => {\n\n    // set up all global options and elements we'll need\n    initTemporaryGlobals(options);\n\n    // add debug notice, modal, and bottom bar to the page \n    // (relies on selectors in temporary globals being defined)\n    initDomElements();\n\n    // trigger the popups when data is right \n    // (relies on DOM elements being present)\n    watchTriggerData();\n\n    // set up global options that need to persist through page loads (e.g. page views, scroll percentage, active time on site)\n    // (should be called after trigger data watchers, so they'll trigger immediately on page load)\n    initPersistentGlobals();\n\n    // set up event listeners for debug notice\n    initDebugNoticeEventListeners();\n\n    // set up event listeners for email popup\n    initModalEventListeners();\n\n    // set up event listeners for email popup\n    initBottomBarEventListeners();\n\n  });\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","export default function domReady(fn) {\n  if (document.readyState != 'loading'){\n    fn();\n  } else {\n    document.addEventListener('DOMContentLoaded', fn);\n  }\n}","import temporaryGlobals from \"./temporary-globals\";\nimport getElem from \"../dom/get-elem\";\n\nexport default function initTemporaryGlobals (userDefinedGlobals) {\n  const SELECTORS = {\n    MODAL_ELEM_SELECTOR: \".email-modal\",\n    MODAL_FORM_ELEM_SELECTOR: \".email-modal__content\",\n    MODAL_FORM_INPUT_ELEM_SELECTOR: \".email-signup-form-input\",\n    MODAL_CLOSE_BUTTON_ELEM_SELECTOR: \".email-modal__close\",\n    BOTTOM_BAR_ELEM_SELECTOR: \".bottom-bar\",\n    BOTTOM_BAR_FORM_INPUT_ELEM_SELECTOR: \".email-signup-form-input\",\n    BOTTOM_BAR_FORM_ELEM_SELECTOR: \"form.bottom-bar__content\",\n    BOTTOM_BAR_CLOSE_BUTTON_ELEM_SELECTOR: \".bottom-bar__close\",\n    DEBUG_ELEM: \".polite-email-popup__debug-notice\",\n    DEBUG_ELEM_RESET_SELECTOR: \".debug-email-forms__reset\",\n    DEBUG_ELEM_BYPASS_SELECTOR: \".debug-email-forms__bypass\"\n  };\n\n  const defaultGlobals = {\n    \n    // USER DEFAULTS\n    showDebugNotice: false,\n    websiteType: \"content\", // \"content\" or \"marketing\"\n    beSlightlyMoreAggressive: false,\n    onSubmit: () => {},\n    imageSrc: \"\",\n    headingText: \"Sign up for updates\",\n    descriptionText: \"Get cutting edge articles and insights into our process\",\n    mainButtonText: \"Sign up\",\n    closeButtonText: \"Close\",\n    showFormSubmissionNotices: true,\n    successMessage: \"Thank you signing up!\",\n    failureMessage: \"Sorry, sign up failed...\",\n    mailchimpConfig: {},\n\n    // SYSTEM GLOBALS\n    SELECTORS: SELECTORS,\n    IS_MOBILE: window.matchMedia(\"only screen and (max-width: 780px)\").matches,\n    FOCUSABLE_SELECTORS: 'a[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), *[tabindex]',\n    BODY_CLASS_MODAL_OPEN: 'email-modal-is-open',\n    BODY_CLASS_BOTTOM_BAR_OPEN: 'email-bottom-bar-is-open',\n\n    // SYSTEM FLAGS\n    isModalOpenable: false,\n    isModalOpen: false\n  };\n\n  Object.assign(temporaryGlobals, defaultGlobals, userDefinedGlobals);\n\n  // todo remove\n  window.temporaryGlobals = temporaryGlobals;\n}\n\n\n","export default function getModalTemplateString ({imageSrc, headingText, descriptionText, mainButtonText}) {\n  return `\n<div class=\"email-modal\" role=\"dialog\" aria-labelledby=\"email-modal-title\" aria-describedby=\"email-modal-description\" aria-hidden=\"true\">\n  <form class=\"email-modal__content\" method=\"POST\" action=\"/\">\n    <div class=\"email-modal__top\">\n      ${imageSrc ? `<div class=\"email-modal__top-media\">\n        <img class=\"email-modal__top-image\" src=\"${imageSrc}\">\n      </div>` : \"\"}\n      <div class=\"email-modal__top-content\">\n        <h2 class=\"email-modal__title\" id=\"email-modal-title\">${headingText}</h2>\n        <p class=\"email-modal__description\" id=\"email-modal-description\">${descriptionText}</p>\n      </div>\n    </div>\n    <div class=\"email-modal__input-container\">\n      <input class=\"email-modal__input email-signup-form-input\" type=\"email\" name=\"EMAIL\" value=\"\" placeholder=\"Your email address\" required>\n      <div style=\"position: absolute; left: -5000px;\" aria-hidden=\"true\">\n        <input class=\"js-validate-not-robot\" type=\"text\" tabindex=\"-1\" value=\"\">\n      </div>\n    </div>\n    <div class=\"email-modal__button-container\">\n      <button class=\"email-modal__sign-up\" type=\"submit\">${mainButtonText}</button>\n    </div>\n    <button class=\"email-modal__close\" type=\"button\"></button>\n  </form>\n</div>\n`;\n}","import temporaryGlobals from \"../temporary-globals/temporary-globals\";\nimport getElem from \"./get-elem\";\n\nexport default function initElemGlobals () {\n  let {SELECTORS} = temporaryGlobals;\n\n  Object.assign(temporaryGlobals, {\n    MODAL_ELEM: getElem(SELECTORS.MODAL_ELEM_SELECTOR),\n    MODAL_FORM_ELEM: getElem(SELECTORS.MODAL_FORM_ELEM_SELECTOR),\n    MODAL_CLOSE_BUTTON_ELEM: getElem(SELECTORS.MODAL_CLOSE_BUTTON_ELEM_SELECTOR),\n    BOTTOM_BAR_ELEM: getElem(SELECTORS.BOTTOM_BAR_ELEM_SELECTOR),\n    BOTTOM_BAR_FORM_ELEM: getElem(SELECTORS.BOTTOM_BAR_FORM_ELEM_SELECTOR),\n    BOTTOM_BAR_CLOSE_BUTTON_ELEM: getElem(SELECTORS.BOTTOM_BAR_CLOSE_BUTTON_ELEM_SELECTOR),\n    DEBUG_NOTICE_ELEM: getElem(SELECTORS.DEBUG_ELEM)\n  });\n}","/*\n  Exit Intent\n  ===========\n  Triggers a callback whenever the user is about to leave the page\n\n  - Isn't aggressive\n    - Will only trigger once\n    - Will only trigger when the mouse is near top of page\n  - Addresses Firefox bugs with INPUT and SELECT elements\n*/\n\nexport default function onExitIntent (exitIntentCallback) {\n  function onMouseOut(event) {\n    let mouseNearTopOfPage = event.clientY < 20;\n    let mouseDidntEnterAnotherElement = event.relatedTarget === null;\n    let mouseEventIsNotInsideAnInputElement = event.target.nodeName.toLowerCase() !== \"select\" && event.target.nodeName.toLowerCase() !== \"input\"; \n\n    if (mouseNearTopOfPage && mouseDidntEnterAnotherElement && mouseEventIsNotInsideAnInputElement) {\n      // document.removeEventListener(\"mouseout\", onMouseOut);\n      if (exitIntentCallback) {\n        exitIntentCallback();\n      }\n    }\n  }\n  document.addEventListener(\"mouseout\", onMouseOut);\n}","import temporaryGlobals from \"../temporary-globals/temporary-globals\";\nimport addHtmlToPage from \"./add-html-to-page\";\nimport getModalTemplateString from \"../modal/get-modal-template-string\";\nimport getBottomBarTemplateString from \"../bottom-bar/get-bottom-bar-template-string\";\nimport initElemGlobals from \"./init-elem-globals\";\nimport getStylesString from \"../helpers/get-styles-string\";\n\nexport default function initDomElements () {\n  addHtmlToPage(getStylesString());\n\n  if (temporaryGlobals.showDebugNotice) {\n    addHtmlToPage(\"<div class='polite-email-popup__debug-notice'></div>\");\n  }\n\n  // Add modal to page\n  addHtmlToPage(getModalTemplateString(temporaryGlobals));\n\n  // Add bottom bar to page\n  addHtmlToPage(getBottomBarTemplateString(temporaryGlobals));\n\n  // Add elements to temporary globals\n  initElemGlobals();\n}","export default function getBottomBarTemplateString ({headingText, mainButtonText, closeButtonText}) {\n  return `<div class=\"bottom-bar\" aria-hidden=\"true\">\n  <form class=\"bottom-bar__content\" method=\"POST\" action=\"/\">\n    <label class=\"bottom-bar__label\">\n      <span class=\"bottom-bar__label-text\">${headingText}</span>\n      <input class=\"bottom-bar__input email-signup-form-input\" type=\"email\" name=\"EMAIL\" value=\"\" placeholder=\"Your email address\" required>\n      <div style=\"position: absolute; left: -5000px;\" aria-hidden=\"true\">\n        <input class=\"js-validate-not-robot\" type=\"text\" tabindex=\"-1\" value=\"\">\n      </div>\n    </label>\n    <button class=\"bottom-bar__sign-up\" type=\"submit\">${mainButtonText}</button>\n  </form>\n  <div class=\"bottom-bar__close-container\">\n    <button class=\"bottom-bar__close\" type=\"button\">\n      <span class=\"hide-mobile\">${closeButtonText}</span>\n      <span class=\"bottom-bar__close-x-icon hide-desktop\"><span></span></span>\n    </button>\n  </div>\n</div>`;\n}","function n(n,t){var i=!0,o=!1;return function(){var c=arguments;o||(o=!0,setTimeout(function(){n.apply(void 0,[].slice.call(c)),o=!1},i?0:t),i=!1)}}function t(n,t){var i;return function(){var o=arguments;clearTimeout(i),i=setTimeout(function(){n.apply(void 0,[].slice.call(o))},t)}}export{t as debounce,n as throttle};\n//# sourceMappingURL=stormcloud.module.js.map\n","import temporaryGlobals from \"../temporary-globals/temporary-globals\";\nimport {persistentGlobals} from \"../persistent-globals/persistent-globals\";\n\nexport default function initDebugNoticeEventListeners () {\n  if (temporaryGlobals.showDebugNotice) {\n    document.addEventListener(\"click\", event => {\n\n      if (event.target.closest(temporaryGlobals.SELECTORS.DEBUG_ELEM_RESET_SELECTOR)) {\n        window.localStorage.clear(); \n        window.location.reload();\n      }\n\n      if (event.target.closest(temporaryGlobals.SELECTORS.DEBUG_ELEM_BYPASS_SELECTOR)) {\n        persistentGlobals.pageViews = 100;\n        persistentGlobals.activeTimeOnPage = 100;\n        persistentGlobals.activeTimeOnSite = 100;\n        persistentGlobals.highestScrollPercentageAcrossAllPages = 100;\n\n        let oneDay = 1000 * 60 * 60 * 24;\n        persistentGlobals.modalClosedDate = Date.now() - (oneDay * 2);\n        persistentGlobals.bottomBarClosedDate = Date.now() - (oneDay * 2);\n      }\n\n    });\n  }\n}","import temporaryGlobals from \"../temporary-globals/temporary-globals\";\nimport onExitIntent from \"../helpers/on-exit-intent\";\nimport openModal from \"./modal-actions/open-modal\";\n\n\n// adds exit intent event listener\nexport default function initExitIntent () {\n  onExitIntent(() => {\n    if (temporaryGlobals.isModalOpenable) {\n      openModal();\n    }\n  });\n}","import temporaryGlobals from \"../../temporary-globals/temporary-globals\";\nimport { disableBodyScroll } from 'body-scroll-lock';\nimport {whenTriggerDataChanges} from \"../../trigger-popups/watch-trigger-data\";\n\nexport default function openModal() {\n\n  // store the active element so it can regain focus after modal is closed\n  temporaryGlobals.activeElement = document.activeElement;\n\n  // show the modal\n  temporaryGlobals.MODAL_ELEM.classList.add(\"show\");\n  // add body class\n  document.body.classList.add(temporaryGlobals.BODY_CLASS_MODAL_OPEN);\n  \n  // Focus the first element within the modal. Make sure the element is visible and doesnt have focus disabled (tabindex=-1);\n  temporaryGlobals.MODAL_ELEM.querySelector(temporaryGlobals.FOCUSABLE_SELECTORS).focus();\n\n  // Trap the tab focus by disable tabbing on all elements outside of your modal.\n  // These elements need to be gotten at the time the modal is opened because they may have been added to the page dynamically\n  const focusableElements = document.querySelectorAll(temporaryGlobals.FOCUSABLE_SELECTORS);\n  const focusableElementsInModal = temporaryGlobals.MODAL_ELEM.querySelectorAll(temporaryGlobals.FOCUSABLE_SELECTORS);\n  const focusableElementsInModalArray = Array.from(focusableElementsInModal);\n  focusableElements.forEach(el => {\n    if (!focusableElementsInModalArray.includes(el)) {\n      el.setAttribute('tabindex', '-1');\n    }\n  });\n\n  // Trap the screen reader focus as well with aria roles.\n  temporaryGlobals.MODAL_ELEM.removeAttribute('aria-hidden');\n  const topLevelElements = Array.from(document.body.children);\n  topLevelElements.forEach(el => {\n    if (el !== temporaryGlobals.MODAL_ELEM) {\n      el.setAttribute('aria-hidden', 'true');\n    }\n  });\n\n  disableBodyScroll(temporaryGlobals.MODAL_ELEM);\n\n  temporaryGlobals.isModalOpen = true;\n  // manually recompute `isModalOpenable` because temporary globals don't trigger this automatically\n  whenTriggerDataChanges();\n\n}","import temporaryGlobals from \"../temporary-globals/temporary-globals\";\nimport {onSubmit} from \"../event-handlers/on-submit\";\nimport closeBottomBar from \"./bottom-bar-actions/close-bottom-bar\";\n\nexport default function initBottomBarEventListeners () {\n  temporaryGlobals.BOTTOM_BAR_FORM_ELEM.addEventListener(\"submit\", onSubmit);\n  temporaryGlobals.BOTTOM_BAR_CLOSE_BUTTON_ELEM.addEventListener('click', closeBottomBar);\n}\n","import initEmailForms from \"./init-email-forms\";\n\nfunction contentWebsite (options) {\n  options.websiteType = \"content\";\n  initEmailForms(options);\n}\n\nfunction marketingWebsite (options) {\n  options.websiteType = \"marketing\";\n  initEmailForms(options);\n}\n\nexport default {\n  contentWebsite,\n  marketingWebsite\n}"],"names":["t","r","n","Object","prototype","e","Function","toString","o","hasOwnProperty","a","call","i","c","getPrototypeOf","u","length","Array","l","Symbol","iterator","isArray","slice","constructor","name","from","test","done","value","TypeError","next","bind","f","this","callbacksLookup","emit","on","push","persistentGlobals","s","y","defaults","JSON","parse","localStorage","getItem","b","assign","Proxy","get","p","set","setItem","stringify","v","g","d","forEach","prop","path","oldValue","Date","getTime","__isDate","ms","tigerlily","window","getDaysSinceModalClosed","getDaysSinceClosed","getDaysSinceBottomBarClosed","popupType","closedDate","modalClosedDate","bottomBarClosedDate","days","Math","floor","now","minimumsLookup","pageViews","content","notAggressive","aggressive","marketing","activeTimeOnPage","activeTimeOnSite","highestScrollPercentageAcrossAllPages","whenTriggerDataChanges","websiteType","requirements","actual","meetsRequirements","daysSinceModalClosed","temporaryGlobals","beSlightlyMoreAggressive","keys","every","key","isModalOpen","modalMeetsRequirements","modalRequirements","modalActualValues","daysSinceBottomBarClosed","bottomBarMeetsTriggerRequirements","bottomBarMeetsRequirements","bottomBarRequirements","bottomBarActualValues","isModalOpenable","BOTTOM_BAR_ELEM","classList","add","document","body","BODY_CLASS_BOTTOM_BAR_OPEN","showDebugNotice","DEBUG_NOTICE_ELEM","innerHTML","charAt","toUpperCase","getDebugNoticeTemplateString","cache","getElem","selector","querySelector","isNumberDefined","val","Number","isNaN","addHtmlToPage","htmlString","insertAdjacentHTML","notyf","Notyf","duration","position","x","dismissible","showSuccessMessage","msg","success","closeBottomBar","remove","_toConsumableArray","arr","arr2","hasPassiveEvents","passiveTestOptions","passive","addEventListener","removeEventListener","isIosDevice","navigator","platform","maxTouchPoints","locks","documentListenerAdded","initialClientY","previousBodyOverflowSetting","previousBodyPaddingRight","allowTouchMove","el","some","lock","options","preventDefault","rawEvent","event","target","touches","closeModal","MODAL_ELEM","BODY_CLASS_MODAL_OPEN","querySelectorAll","FOCUSABLE_SELECTORS","removeAttribute","setAttribute","activeElement","focus","targetElement","console","error","ontouchstart","ontouchmove","filter","undefined","setTimeout","style","paddingRight","overflow","enableBodyScroll","onSubmit","currentTarget","closest","email","SELECTORS","BOTTOM_BAR_FORM_INPUT_ELEM_SELECTOR","mailchimpConfig","spamPreventionKey","formAction","url","replace","data","inputs","encodeURIComponent","script","createElement","src","appendChild","res","removeChild","showFormSubmissionNotices","result","successMessage","failureMessage","sendEmailToMailChimp","onKeyDown","keyCode","contains","onClickModalBackdrop","MODAL_FORM_ELEM_SELECTOR","initEmailForms","fn","userDefinedGlobals","defaultGlobals","imageSrc","exitIntentCallback","headingText","descriptionText","mainButtonText","closeButtonText","MODAL_ELEM_SELECTOR","MODAL_FORM_INPUT_ELEM_SELECTOR","MODAL_CLOSE_BUTTON_ELEM_SELECTOR","BOTTOM_BAR_ELEM_SELECTOR","BOTTOM_BAR_FORM_ELEM_SELECTOR","BOTTOM_BAR_CLOSE_BUTTON_ELEM_SELECTOR","DEBUG_ELEM","DEBUG_ELEM_RESET_SELECTOR","DEBUG_ELEM_BYPASS_SELECTOR","IS_MOBILE","matchMedia","matches","MODAL_FORM_ELEM","MODAL_CLOSE_BUTTON_ELEM","BOTTOM_BAR_FORM_ELEM","BOTTOM_BAR_CLOSE_BUTTON_ELEM","arguments","apply","throttle","currentScrollPercentage","docScrollHeight","scrollPercentage","max","scrollHeight","documentElement","offsetHeight","clientHeight","pageYOffset","clear","location","reload","oneDay","focusableElements","focusableElementsInModal","focusableElementsInModalArray","includes","children","concat","targetTouches","clientY","scrollTop","isTargetElementTotallyScrolled","stopPropagation","handleScroll","_lock","disableBodyScroll","openModal","mouseNearTopOfPage","mouseDidntEnterAnotherElement","relatedTarget","mouseEventIsNotInsideAnInputElement","nodeName","toLowerCase","readyState","contentWebsite","marketingWebsite"],"mappings":"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"}