var e={},t={};function n(e){return t[e]||document.querySelector(e)}window.temporaryGlobals=e;var o,i,a=Object.prototype,r=Function.prototype.toString,l=a.hasOwnProperty,c=r.call(Object),s=a.toString,u=(o=Object.getPrototypeOf,i=Object,function(e){return o(i(e))});function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function m(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return d(e,void 0);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,void 0):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0;return function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(n=e[Symbol.iterator]()).next.bind(n)}function E(){this.callbacksLookup={}}E.prototype={emit:function(e,t){for(var n,o=this.callbacksLookup["*"]||[],i=m(this.callbacksLookup[e]||[]);!(n=i()).done;)(0,n.value)({name:e,value:t});for(var a,r=m(o);!(a=r()).done;)(0,a.value)({name:e,value:t})},on:function(e,t){for(var n,o=m(Array.isArray(e)?e:[e]);!(n=o()).done;){var i=n.value;this.callbacksLookup[i]||(this.callbacksLookup[i]=[]),this.callbacksLookup[i].push(t)}}};var v=new E;function f(e,t){void 0===t&&(t={}),e=e||"tigerlily";var n=t.defaults,o=void 0===n?{}:n,i=JSON.parse(localStorage.getItem(e)||"{}",T);return i=Object.assign(o,i),new Proxy(i,function t(n){return{get:function(e,o){return g(e[o])?new Proxy(e[o],t(n)):e[o]},set:function(t,o,i){t[o]=i,localStorage.setItem(e,JSON.stringify(n,S));var a=t[o],d=g(a)?JSON.parse(JSON.stringify(a,S),T):a,m=g(i)?JSON.parse(JSON.stringify(i,S),T):i,E=function(e,t){if(e===t)return"";var n="";return function e(t,n,o){o=o||"",Array.isArray(t)?function(t,n,o){t.forEach((t,i,a)=>{const r=`${o}[${i}]`;n.call(a,t,i,a,r),e(a[i],n,r)})}(t,n,o):function(e){if(!function(e){return!!e&&"object"==typeof e}(e)||"[object Object]"!=s.call(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e))return!1;var t=u(e);if(null===t)return!0;var n=l.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&r.call(n)==c}(t)&&function(t,n,o){for(const i in t){const a=o?`${o}.${i}`:i;n.call(t,t[i],i,t,a),e(t[i],n,a)}}(t,n,o)}(e,function(e,o,i,a){e===t&&(n=a)}),n}(n,i)||o;return v.emit(E,{prop:o,path:E,oldValue:d,value:m}),!0}}}(i))}function g(e){return"object"==typeof e&&null!==e&&!(e instanceof Date)}function S(e,t){if(this[e]instanceof Date){var n=this[e].getTime();return n?{__isDate:!0,ms:n}:void 0}return t}function T(e,t){return t.__isDate?new Date(t.ms):t}function b(e,t){var n=localStorage.getItem("an-awesome-localstorage-db"),o=n?JSON.parse(n):{};return o[e]=t,localStorage.setItem("an-awesome-localstorage-db",JSON.stringify(o)),t}function _(e){return(localStorage.getItem("an-awesome-localstorage-db")?JSON.parse(localStorage.getItem("an-awesome-localstorage-db")):{})[e]}f.on=function(e,t){v.on(e,function(e){t(e.value)})},f("polite-email-popup");var O={set:b,get:_,increment:function(e){var t=_(e)||0;return b(e,++t),t}},p=function(e,t){var n=new CustomEvent(e,{detail:t});document.dispatchEvent(n)},A=function(e,t){document.addEventListener(e,function(e){t(e.detail)},!1)},h={WEBSITE_TYPES:{CONTENT:"CONTENT",MARKETING:"MARKETING"},FOCUSABLE_SELECTORS:"a[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), *[tabindex]",IS_MOBILE:window.matchMedia("only screen and (max-width: 780px)").matches,MODAL_ELEM_SELECTOR:".email-modal",MODAL_ELEM_FORM_SELECTOR:".email-modal__content",MODAL_ELEM_CLOSE_BUTTON_SELECTOR:".email-modal__close",BODY_CLASS_MODAL_OPEN:"email-modal-is-open",MODAL_IS_OPENABLE:!1,SITE_PAGE_VIEWS:0,HIGHEST_SCROLL_PERCENTAGE:0,ACTIVE_TIME_ON_SITE:0,ACTIVE_TIME_ON_PAGE:0,setActiveElement:function(e){this.activeElement=e},getActiveElement:function(){return this.activeElement},setModalAsOpenable:function(){this.MODAL_IS_OPENABLE=!0,p("MODAL_IS_OPENABLE",!0)},isModalOpenable:function(){return this.MODAL_IS_OPENABLE},getHighestScrollPercentage:function(){return this.HIGHEST_SCROLL_PERCENTAGE},getActiveTimeOnSite:function(){return this.ACTIVE_TIME_ON_SITE},getActiveTimeOnPage:function(){return this.ACTIVE_TIME_ON_PAGE},incrementSitePageViews:function(){var e=O.increment("pageViews");this.SITE_PAGE_VIEWS=e,p("pageData",{pageViews:e})},setHighestScrollPercentage:function(e){var t=O.get("highestScrollPercentage")||0,n=e>t?e:t;O.set("highestScrollPercentage",n),this.HIGHEST_SCROLL_PERCENTAGE=n,p("pageData",{highestScrollPercentage:n})},incrementActiveTimeOnSite:function(e){var t=O.increment("activeTimeOnSite");this.ACTIVE_TIME_ON_SITE=t,p("pageData",{activeTimeOnSite:t})},incrementActiveTimeOnPage:function(e){this.ACTIVE_TIME_ON_PAGE+=1,p("pageData",{activeTimeOnPage:this.ACTIVE_TIME_ON_PAGE})}},y=function(e,t){var n=!0,o=!1;return function(){var e=arguments;o||(o=!0,setTimeout(function(){1e3.apply(void 0,[].slice.call(e)),o=!1},n?0:t),n=!1)}}(0,function(){var e,t;h.setHighestScrollPercentage((e=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight),t=window.pageYOffset/(e-document.documentElement.clientHeight),Math.floor(100*t))),h.incrementActiveTimeOnSite(),h.incrementActiveTimeOnPage()});function L(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var I=!1;if("undefined"!=typeof window){var w={get passive(){I=!0}};window.addEventListener("testPassive",null,w),window.removeEventListener("testPassive",null,w)}var M="undefined"!=typeof window&&window.navigator&&window.navigator.platform&&(/iP(ad|hone|od)/.test(window.navigator.platform)||"MacIntel"===window.navigator.platform&&window.navigator.maxTouchPoints>1),C=[],N=!1,P=-1,D=void 0,x=void 0,B=function(e){return C.some(function(t){return!(!t.options.allowTouchMove||!t.options.allowTouchMove(e))})},R=function(e){var t=e||window.event;return!!B(t.target)||t.touches.length>1||(t.preventDefault&&t.preventDefault(),!1)};function G(){document.body.classList.remove(h.BODY_CLASS_MODAL_OPEN),h.modalElem.style.display="none",document.querySelectorAll(h.FOCUSABLE_SELECTORS).forEach(function(e){return e.removeAttribute("tabindex")}),document.querySelectorAll("body > [aria-hidden]").forEach(function(e){return e.removeAttribute("aria-hidden")}),h.modalElem.setAttribute("aria-hidden","true");var e=h.getActiveElement();e&&e.focus(),function(e){if(M){if(!e)return void console.error("enableBodyScroll unsuccessful - targetElement must be provided when calling enableBodyScroll on IOS devices.");e.ontouchstart=null,e.ontouchmove=null,C=C.filter(function(t){return t.targetElement!==e}),N&&0===C.length&&(document.removeEventListener("touchmove",R,I?{passive:!1}:void 0),N=!1)}else(C=C.filter(function(t){return t.targetElement!==e})).length||setTimeout(function(){void 0!==x&&(document.body.style.paddingRight=x,x=void 0),void 0!==D&&(document.body.style.overflow=D,D=void 0)})}(h.modalElem)}var V=["pageViews","highestScrollPercentage","activeTimeOnSite","activeTimeOnPage"],H={pageViews:"",highestScrollPercentage:"%",activeTimeOnSite:"s",activeTimeOnPage:"s"};function k(t){var o,i=t.showDebugNotice,a=void 0!==i&&i,r=t.websiteType,l=t.beSlightlyMoreAggressive,c=void 0!==l&&l,s=t.onSubmit,u=void 0===s?function(){}:s,d=t.imageSrc,m=void 0===d?"":d,E=t.headingText,v=void 0===E?"Sign up for updates":E,f=t.descriptionText,g=void 0===f?"Get cutting edge articles and insights into our process":f,S=t.mainButtonText,T=void 0===S?"Sign up":S,b=t.closeButtonText,_=void 0===b?"Close":b;console.log("xxxx"),o=function(){var t,o;t={showDebugNotice:a,websiteType:r,beSlightlyMoreAggressive:c,imageSrc:m,headingText:v,descriptionText:g,mainButtonText:T,closeButtonText:_},console.log(0x2bbdfb99bd357c),Object.keys(t).forEach(function(n){e[n]=t[n]}),Object.assign(e,{WEBSITE_TYPES:{CONTENT:"CONTENT",MARKETING:"MARKETING"},IS_MOBILE:window.matchMedia("only screen and (max-width: 780px)").matches,FOCUSABLE_SELECTORS:"a[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), *[tabindex]",BODY_CLASS_MODAL_OPEN:"email-modal-is-open",MODAL_ELEM:n(".email-modal"),MODAL_FORM_ELEM:n(".email-modal__content"),MODAL_CLOSE_BUTTON_ELEM:n(".email-modal__close")}),function(e){var t=(void 0).imageSrc,n=(void 0).headingText,o=(void 0).descriptionText,i=(void 0).mainButtonText;(void 0).showDebugNotice&&document.body.insertAdjacentHTML("beforeend",'<div class="debug-emails-forms">\n    <div>\n      <b>Page views: </b><span data-event-name="pageViews">0</span>\n    </div>\n    <div>\n      <b>Scroll percentage: </b><span data-event-name="highestScrollPercentage">0%</span>\n    </div>\n    <div>\n      <b>Time on site: </b><span data-event-name="activeTimeOnSite">0s</span>\n    </div>\n    <div>\n      <b>Time on page: </b><span data-event-name="activeTimeOnPage">0s</span>\n    </div>\n    <div>\n      <b>Saw modal: </b><span>never</span>\n    </div>\n    <div>\n      <b>Closed modal: </b><span>never</span>\n    </div>\n    <div>\n      <b>Closed bottom bar: </b><span>never</span>\n    </div>\n    <div>\n      <b>Modal is openable: </b><span data-event-name="modalIsOpenable">false</span>\n    </div>\n    <button class="debug-emails-forms__reset" type="button">Reset</button>\n  </div>');var a=getTemplateString({imageSrc:t,headingText:n,descriptionText:o,mainButtonText:i});document.body.insertAdjacentHTML("beforeend",a)}(),a&&(A("pageData",function(e){var t=V.find(function(t){return e.hasOwnProperty(t)}),n=e[t]+H[t];document.querySelector(".debug-emails-forms [data-event-name='"+t+"']").innerText=n}),A("MODAL_IS_OPENABLE",function(e){document.querySelector(".debug-emails-forms [data-event-name='modalIsOpenable']").innerText=e?"true":"false"}),document.querySelector(".debug-emails-forms__reset").addEventListener("click",function(e){window.localStorage.clear(),window.location.reload()})),function(e){var t=e.onSubmit;globals.modalElem=document.querySelector(globals.MODAL_ELEM_CLASS),globals.modalElemForm=document.querySelector(globals.MODAL_ELEM_FORM_CLASS),globals.modalElemCloseButton=document.querySelector(globals.MODAL_ELEM_CLOSE_BUTTON_CLASS),globals.onSubmit=t,h.modalElem.addEventListener("click",function(e){({event:e}).event.target.closest(h.MODAL_ELEM_FORM_CLASS)||G()}),h.modalElemForm.addEventListener("submit",function(e){return function(e){var t=e.event;t.preventDefault();var n=t.currentTarget.querySelector(".email-signup-form-input");h.onSubmit({event:t,email:n.value}),G()}({event:e})}),h.modalElemCloseButton.addEventListener("click",function(){return G()}),document.addEventListener("keydown",function(e){27==={event:e}.event.keyCode&&document.body.classList.contains(h.BODY_CLASS_MODAL_OPEN)&&G()})}({onSubmit:u,imageSrc:m,headingText:v,descriptionText:g,mainButtonText:T}),h.incrementSitePageViews(),window.addEventListener("scroll",y),function(e){var t=e.websiteType,n=e.beSlightlyMoreAggressive;A("pageData",function(e){var o=function(e){var t=e.websiteType,n=e.beSlightlyMoreAggressive;return t===h.WEBSITE_TYPES.CONTENT?n?{ACTIVE_TIME_ON_PAGE:6,ACTIVE_TIME_ON_SITE:20,HIGHEST_SCROLL_PERCENTAGE:25}:{ACTIVE_TIME_ON_PAGE:8,ACTIVE_TIME_ON_SITE:30,HIGHEST_SCROLL_PERCENTAGE:35}:t===h.WEBSITE_TYPES.MARKETING?n?{ACTIVE_TIME_ON_PAGE:6,SITE_PAGE_VIEWS:2,ACTIVE_TIME_ON_SITE:20}:{ACTIVE_TIME_ON_PAGE:8,SITE_PAGE_VIEWS:3,ACTIVE_TIME_ON_SITE:30}:void 0}({websiteType:t,beSlightlyMoreAggressive:n});Object.keys(o).every(function(e){return h[e]>=o[e]})&&h.setModalAsOpenable()})}({websiteType:r,beSlightlyMoreAggressive:c}),o=function(){h.isModalOpenable()&&function(){h.setActiveElement(document.activeElement),h.modalElem.style.display="flex",document.body.classList.add(h.BODY_CLASS_MODAL_OPEN),h.modalElem.querySelector(h.FOCUSABLE_SELECTORS).focus();var e=document.querySelectorAll(h.FOCUSABLE_SELECTORS),t=h.modalElem.querySelectorAll(h.FOCUSABLE_SELECTORS),n=Array.from(t);e.forEach(function(e){n.includes(e)||e.setAttribute("tabindex","-1")}),h.modalElem.removeAttribute("aria-hidden"),Array.from(document.body.children).forEach(function(e){e!==h.modalElem&&e.setAttribute("aria-hidden","true")}),function(e,t){if(M){if(!e)return void console.error("disableBodyScroll unsuccessful - targetElement must be provided when calling disableBodyScroll on IOS devices.");if(e&&!C.some(function(t){return t.targetElement===e})){var n={targetElement:e,options:{}};C=[].concat(L(C),[n]),e.ontouchstart=function(e){1===e.targetTouches.length&&(P=e.targetTouches[0].clientY)},e.ontouchmove=function(t){1===t.targetTouches.length&&function(e,t){var n=e.targetTouches[0].clientY-P;!B(e.target)&&(t&&0===t.scrollTop&&n>0||function(e){return!!e&&e.scrollHeight-e.scrollTop<=e.clientHeight}(t)&&n<0?R(e):e.stopPropagation())}(t,e)},N||(document.addEventListener("touchmove",R,I?{passive:!1}:void 0),N=!0)}}else{setTimeout(function(){void 0===x&&(window,document),void 0===D&&(D=document.body.style.overflow,document.body.style.overflow="hidden")});var o={targetElement:e,options:{}};C=[].concat(L(C),[o])}}(h.modalElem)}()},document.addEventListener("mouseout",function(e){var t=e.clientY<20,n=null===e.relatedTarget,i="select"!==e.target.nodeName.toLowerCase()&&"input"!==e.target.nodeName.toLowerCase();t&&n&&i&&o&&o()})},"loading"!=document.readyState?o():document.addEventListener("DOMContentLoaded",o)}var j={contentWebsite:function(e){e.websiteType=h.WEBSITE_TYPES.CONTENT,k(e)},marketingWebsite:function(e){e.websiteType=h.WEBSITE_TYPES.MARKETING,k(e)}};export default j;
//# sourceMappingURL=polite-email-popup.module.js.map
